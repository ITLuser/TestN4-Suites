'USEUNIT CommonRoutines
'USEUNIT N4MobileCommonRoutines

'To Enter Container or Chassis for GateInspection in N4 Mobile
'Input Parameters: By using Dictionary Object
'Created: 13/06/2018 
'Created by: Aswini Uthayakumar
'Reviewed:
'Reviewed by:
Sub n4mobileGateInspectionEnterContainerOrChassis
Call CommonRoutines.fetchData("N4MobileCommonRoutines")
Dim ObjChassis, ObjCheckElement, ObjContainer, ObjSend
  Set ObjContainer = Aliases.browser.FindChild("idStr","program:MROD001-mContainer_input",20,True)
  Set ObjChassis = Aliases.browser.FindChild("idStr","program:MROD005-inspChassisId_input",20,True)
    If ObjContainer.WaitProperty("Exists", True,5000) Then
      SelContainerOrChassis = (flowData.Item("n4GInspContainerOrChassis"))
        If SelContainerOrChassis = "Container" Then
          ObjContainer.SetText(flowData.Item("n4GInspContainerNbr"))
          ObjChassis.setText(" ")
          Set ObjSend = Aliases.browser.FindChild("idStr","program:one_2_SEND",20,True)
          Call CommonRoutines.ClickOperation(ObjSend,"Send Button")
          Set ObjCheckElement = Aliases.browser.FindChild("idStr","program:MROD002-mLicense_input",20,True)
            If ObjCheckElement.WaitProperty("Exists", True,5000) Then
              Log.Checkpoint("Container Entered for Gate Inspection")
            Else
              Log.Error("Failed to enter Container for Gate Inspection")
            End If
        ElseIf SelContainerOrChassis = "Chassis" Then
          ObjContainer.SetText(" ")
          ObjChassis.SetText(flowData.Item("n4GInspChassisNbr"))
          Set ObjSend = Aliases.browser.FindChild("idStr","program:one_2_SEND",20,True)
          Call CommonRoutines.ClickOperation(ObjSend,"Send Button")
          Set ObjCheckElement = Aliases.browser.FindChild("idStr","program:MROD022-mLicense_input",20,True)
            If ObjCheckElement.WaitProperty("Exists", True,5000) Then
              Log.Checkpoint("Chassis Entered for Gate Inspection")
            Else
              Log.Error("Failed to enter Chassis for Gate Inspection")
            End If
        End If
    End If
End Sub

'To Update Damage to Container through GateInspection in N4 Mobile
'Input Parameters: By using Dictionary Object
'Created: 13/06/2018 
'Created by: Aswini Uthayakumar
'Reviewed:
'Reviewed by:
Sub n4mobileGateInspectionUpdateContainerDamage
Call CommonRoutines.fetchData("N4MobileCommonRoutines")
Dim ObjCheckElement, ObjCommit, ObjDamageButton, ObjDamageComponent, ObjDamageDepth, ObjDamageLength, ObjDamageLocation, ObjDamageQuantity, ObjDamageSeverity, ObjDamageType, ObjDamageWidth
aqUtils.Delay 1000
  Set ObjDamageButton = Aliases.browser.FindChild("idStr","program:MROD002Buttons-mCtrDamagesButton_input",20,True)
    If ObjDamageButton.WaitProperty("Exists", True,5000) Then
      Call CommonRoutines.ClickOperation(ObjDamageButton,"Damage Button ")
      Set ObjDamageComponent = Aliases.browser.FindChild("idStr","program:MROD004-mDamageC1_input",20,True)
        If ObjDamageComponent.WaitProperty("Exists", True,5000) Then
          Call CommonRoutines.EnterOperation(ObjDamageComponent,flowData.Item("n4GInspDamageComponent"),"Damage Component")
          Set ObjDamageLocation = Aliases.browser.FindChild("idStr","program:MROD004-mDamageL1_input",20,True)
          Call CommonRoutines.EnterOperation(ObjDamageLocation,flowData.Item("n4GInspDamageLocation"),"Damage Location")
          Set ObjDamageType = Aliases.browser.FindChild("idStr","program:MROD004-mDamageT1_input",20,True)
          Call CommonRoutines.EnterOperation(ObjDamageType,flowData.Item("n4GInspDamageType"),"Damage Type")
          Set ObjDamageSeverity = Aliases.browser.FindChild("idStr","program:MROD004-mDamageS1_input",20,True)
          Call CommonRoutines.EnterOperation(ObjDamageSeverity,flowData.Item("n4GInspDamageSeverity"),"Damage Severity")
          Set ObjDamageQuantity = Aliases.browser.FindChild("idStr","program:MROD004-mDamageQ1_input",20,True)
          Call CommonRoutines.EnterOperation(ObjDamageQuantity,flowData.Item("n4GInspDamageQuantity"),"Damage Quantity")
          Set ObjDamageWidth = Aliases.browser.FindChild("idStr","program:MROD004-mDamageW1_input",20,True)
          Call CommonRoutines.EnterOperation(ObjDamageWidth,flowData.Item("n4GInspDamageWidth"),"Damage Width")
          Set ObjDamageLength = Aliases.browser.FindChild("idStr","program:MROD004-mDamageLN1_input",20,True)
          Call CommonRoutines.EnterOperation(ObjDamageLength,flowData.Item("n4GInspDamageLength"),"Damage Length")
          Set ObjDamageDepth = Aliases.browser.FindChild("idStr","program:MROD004-mDamageD1_input",20,True)
          Call CommonRoutines.EnterOperation(ObjDamageDepth,flowData.Item("n4GInspDamageDepth"),"Damage Depth")
          Set ObjSend  = Aliases.browser.FindChild("idStr","program:optional_2_SEND",20,True)
          Call CommonRoutines.ClickOperation(ObjSend, "Send Button")
          Set ObjCommit = Aliases.browser.FindChild("idStr","program:two_2_COMMIT",20,True)
          Call CommonRoutines.ClickOperation(ObjCommit, "Commit Button")
          aqUtils.Delay 1000
          Set ObjCheckElement = Aliases.browser.FindChild("idStr","program:MROD001-mContainer_input",20,True)
            If ObjCheckElement.WaitProperty("Exists", True,5000) Then
              Log.Checkpoint("Damage Updated Successfully")
            Else
              Log.Error("Failed to update damage")
            End If 
        End If
    End If
End Sub