' To reference one unit
'USEUNIT CommonRoutines
'USEUNIT SparcsN4CommonRoutines

'To Create n4Rail Road Operator
'Input Parameters: By using Dictionary Object
'Created: 17/04/2018 
'Created by: Dinesh RameshKumar
'Reviewed:
'Reviewed by:
Sub n4RailRoadOperatorCreate
   Dim ObjCreateButton,ObjId,ObjName,ObjNameSelect,ObjsearchRail,ObjSelectRail,PropArray, ValuesArray
   Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu.Click("Windows|Close All Tabs")
   Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu.Click("Organizations|RailRoad Operators") 
   Set ObjCreateButton = Aliases.jp2launcher.FindChild("AWTComponentName","LABEL_ACTION_CREATE",20, True)
   If ObjCreateButton.WaitProperty("Exists", True,10000) And ObjCreateButton.WaitProperty("Visible", True,10000) Then 
    Call CommonRoutines.ClickOperation(ObjCreateButton,"RailRoadOperator")
    Set ObjId = Aliases.jp2launcher.n4AddRailRoadOperatorWindow.FindChild("AWTComponentName","bzuId",20, True)
    Call CommonRoutines.EnterOperation(ObjId,(flowData.Item("RailId")),"RailID")
    Set ObjName = Aliases.jp2launcher.n4AddRailRoadOperatorWindow.FindChild("AWTComponentName","bzuName",20, True)
    Call CommonRoutines.EnterOperation(ObjName,(flowData.Item("RailName")),"RailName")
    Set ObjCredit = Aliases.jp2launcher.n4AddRailRoadOperatorWindow.FindChild("AWTComponentName","bzuCreditStatus",20, True)
    Call CommonRoutines.EnterOperation(ObjCredit,(flowData.Item("Creditstatus")),"Status") 
    Set ObjScac = Aliases.jp2launcher.n4AddRailRoadOperatorWindow.FindChild("AWTComponentName","bzuScac",20, True) 
    Call CommonRoutines.EnterOperation(ObjScac,(flowData.Item("ScacCode")),"ScacCode")  
    Set ObjBic = Aliases.jp2launcher.n4AddRailRoadOperatorWindow.FindChild("AWTComponentName","bzuBic",20, True) 
    Call CommonRoutines.EnterOperation(ObjBic,(flowData.Item("BicCode")),"BicCode")
    Set ObjSave = Aliases.jp2launcher.n4AddRailRoadOperatorWindow.FindChild("AWTComponentName","LABEL_ACTION_SAVE",20, True) 
    Call CommonRoutines.ClickOperation(ObjSave,"Save")  
    Set Objcancel = Aliases.jp2launcher.n4AddRailRoadOperatorWindow.FindChild("AWTComponentName","LABEL_ACTION_CANCEL",20, True) 
    Call CommonRoutines.ClickOperation(Objcancel,"Save")
    Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu.Click("Windows|Close All Tabs")
    Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu.Click("Organizations|RailRoad Operators") 
    Set ObjsearchRail = Aliases.jp2launcher.n4HomeView.FindChild("AWTComponentName","LABEL__QUICK_SEARCH",20, True)
    call CommonRoutines.EnterOperation(ObjsearchRail,(flowData.Item("RailId")),"Railoperator")
    Call CommonRoutines.EnterOperation(ObjsearchRail,"[Enter]","RailValue")
    Set ObjSelectRail = Aliases.jp2launcher.n4HomeView.FindChild("AWTComponentName","RAL008",20, True)
    ObjSelectRail.selectAll
    Set ObjDeleteButton =  Aliases.jp2launcher.FindChild("AWTComponentName","LABEL_ACTION_DELETE",20, True)
    If ObjDeleteButton.Enabled Then
     Log.Checkpoint ("Rail Road Operator Successfully Created")
    Else 
     Log.Checkpoint ("Failed to Create Rail Road Operator")
    End If
   End If 
End Sub
'To Purge n4Rail Road Operator
'Input Parameters: By using Dictionary Object
'Created: 17/04/2018 
'Created by: Dinesh RameshKumar
'Reviewed:
'Reviewed by:
Sub n4RailRoadOperatorPurge
Dim Objsearch,Objaction,ObjRefresh,ObjDeleteButton
   Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu.Click("Windows|Close All Tabs")
   aqUtils.Delay 500 
   Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu.Click("Organizations|RailRoad Operators") 
   Set Objsearch = Aliases.jp2launcher.n4HomeView.FindChild("AWTComponentName","LABEL__QUICK_SEARCH",20, True)
   call CommonRoutines.EnterOperation(Objsearch,(flowData.Item("RailId")),"Railoperator")
   Call CommonRoutines.EnterOperation(Objsearch,"[Enter]","RailValue")
   Set ObjSelect = Aliases.jp2launcher.n4HomeView.FindChild("AWTComponentName","RAL008",20, True)
   ObjSelect.selectAll
   Set ObjDeleteButton =  Aliases.jp2launcher.FindChild("AWTComponentName","LABEL_ACTION_DELETE",20, True)
   If ObjDeleteButton.Enabled Then
    Set Objaction = Aliases.jp2launcher.FindChild("AWTComponentName","MENU__ACTIONS",20, True)
    Call CommonRoutines.ClickOperation(Objaction,"Action")
    Objaction.SwingPopupMenu.Click("Purge")
    Set ObjRefresh = Aliases.jp2launcher.FindChild("AWTComponentName","LABEL_ACTION_REFRESH",20, True)
    Call CommonRoutines.ClickOperation(ObjRefresh,"Refresh")
    Log.Checkpoint  "RailRoad Operator Successfully Purged " 
   Else
    Log.Checkpoint "RailRoad Operator already Purged"
   End If
End Sub
'To Delete n4Rail Road Operator
'Input Parameters: By using Dictionary Object
'Created: 18/04/2018 
'Created by: Dinesh RameshKumar
'Reviewed:
'Reviewed by:
Sub n4RailRoadOperatorDelete
   Dim ObjSearchVesselVisit,ObjSelectall,ObjDelButtonObjDeleteButton,ObjRfresh,ObjDelButton,ObjLabel
   Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu.Click("Windows|Close All Tabs")
   Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu.Click("Organizations|RailRoad Operators") 
   Set ObjSearchVesselVisit = Aliases.jp2launcher.n4HomeView.FindChild("AWTComponentName","LABEL__QUICK_SEARCH",20, True)
   call CommonRoutines.EnterOperation(ObjSearchVesselVisit,(flowData.Item("RailId")),"Railoperator")
   Call CommonRoutines.EnterOperation(ObjSearchVesselVisit,"[Enter]","RailValue")
   Set ObjSelectall = Aliases.jp2launcher.n4HomeView.FindChild("AWTComponentName","RAL008",20, True)
   ObjSelectall.selectAll
   Set ObjDelButton =  Aliases.jp2launcher.FindChild("AWTComponentName","LABEL_ACTION_DELETE",20, True)
   If ObjDelButton.Enabled Then
    Set ObjDelButton =  Aliases.jp2launcher.FindChild("AWTComponentName","LABEL_ACTION_DELETE",20, True)
    Call CommonRoutines.ClickOperation(ObjDelButton,"Delete icon")
    Set ObjLabel =  Aliases.jp2launcher.FindChild("AWTComponentName","LABEL_YES",20, True)
    Call CommonRoutines.ClickOperation(ObjLabel,"Yes button")
    Set ObjRefresh = Aliases.jp2launcher.FindChild("AWTComponentName","LABEL_ACTION_REFRESH",20, True)
    Call CommonRoutines.ClickOperation(ObjRefresh,"Refresh")
    Log.Checkpoint  "Rail Road Operator Successfully Deleted " 
   Else
    Log.Checkpoint "4Rail Road Operator already Deleted"
   End If
End Sub



