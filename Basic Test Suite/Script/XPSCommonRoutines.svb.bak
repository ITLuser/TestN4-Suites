' To reference one unit
'USEUNIT CommonRoutines

'Opening XPS through Batch file
'Created: 04/04/2018
'Created by: Anantha Narayanan
'Reviewed: 
'Reviewed by:
sub OpenXPS
  Set shell = CreateObject("WScript.Shell")
  shell.CurrentDirectory = "C:\XPS_Batch"
  shell.Run "xps.bat"
  If Aliases.Sparcs_N4_Client.xpsLoginWindow.Exists then 
   Log.Checkpoint "XPS Opened successfully"
  Else
   Log.Error "Unable to open XPS"
  End If
End Sub

'Xps Login
'Created: 04/04/2018
'Created by: Anantha Narayanan
'Reviewed: 
'Reviewed by:
Sub xpsLogIn
  Dim wndASITHREED
  Set wndASITHREED = Aliases.Sparcs_N4_Client.xpsLoginWindow
  Call wndASITHREED.Click(163, 14)
  Call wndASITHREED.Keys("[Down]")
  Call wndASITHREED.Click(148, 97)
  Call wndASITHREED.Keys("[BS][BS][BS][BS][BS][BS]"+flowData.Item("XPS_Username")+"[Tab]"+flowData.Item("XPS_Password")+"[Enter]")
  aqUtils.Delay 2000
  If Aliases.Sparcs_N4_Client.xpsLoginWindow.Exists then 
   Log.Error "XPS Login Failed"
  Else
  Log.Checkpoint "XPS Login successful"
   Aliases.Sparcs_N4_Client.xpsMainWinodw2.Maximize
  End If
  
End Sub

'Loading playscript
'Created: 04/04/2018
'Created by: Anantha Narayanan
'Reviewed: 
'Reviewed by:
Sub xpsSelectPlayScript
  Dim sparcs_N4_Client,wndProToolsMainWndClass
  Set sparcs_N4_Client = Aliases.Sparcs_N4_Client
  Set wndProToolsMainWndClass = sparcs_N4_Client.xpsMainWinodw2
  Call wndProToolsMainWndClass.MainMenu.Click("File|Play Script...")
  If sparcs_N4_Client.xpsPlayScriptSelectWindow.Exists Then 
    Log.Checkpoint "Choose Play Script window is available"
    Call sparcs_N4_Client.xpsPlayScriptSelectWindow.OpenFile(flowData.Item("PlayScript"), "Text Files (*.txt)")
    If wndProToolsMainWndClass.MDIClient.PlayScriptWindow.Exists Then 
      Log.Checkpoint "ScriptPlayer Window is available"
      Call wndProToolsMainWndClass.MDIClient.PlayScriptWindow.Click(274, 67)
    Else
      Log.Error "ScriptPlayer Window is not available"  
    End If
  Else
    Log.Error "Choose Play Script window is not available"
  End If
  
  
End Sub

'Closing playscript window
'Created: 04/04/2018
'Created by: Anantha Narayanan
'Reviewed: 
'Reviewed by:
Sub xpsPlayScriptWindowClose
  Aliases.Sparcs_N4_Client.xpsMainWinodw2.MDIClient.PlayScriptWindow.Close
End Sub


'Closing XPS application
'Created: 04/04/2018
'Created by: Anantha Narayanan
'Reviewed: 
'Reviewed by:
Sub xpsCloseApplication
  Dim AppProcess
 ' Obtains the N4 process
 Set AppProcess = Sys.Process("Sparcs N4 Client")
 ' Closes the process
 AppProcess.Close
End Sub 

Sub play
  Call CommonRoutines.fetchData("xps")
'  Call OpenXPS
'  Call xpsLogIn
call xpsSelectPlayScript
End Sub

