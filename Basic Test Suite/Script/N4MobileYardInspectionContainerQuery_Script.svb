'USEUNIT CommonRoutines
'USEUNIT N4MobileCommonRoutines
'USEUNIT N4MobileYardInventoryCommonRoutines
'USEUNIT SparcsN4CommonRoutines
'USEUNIT SparcsN4VesselRoutines

'Yard Inspection program shows Genset ID and Genset Type.
'Input Parameters: By using Dictionary Object
'Created: 27/06/2018 
'Created by: DineshRameshKumar
'Reviewed:
'Reviewed by:
'#Test Setup:
'#1. Go to Configuration > Equipment Accessories and add an accessory A1 with Equipment Type as Genset.
'#2. Vessel Stow plan a reefer container C1 and discharge it to yard.
'#3. Select the unit in Units table, open unit inspector, select All Equipment tab and add the accessory A1 to the Unit C1.
'#Test Steps
'#1. Login to N4 Mobile, select Yard Inspection, enter container number C1, enter seal and click R button.
'#Expected:
'#1. Genset ID A1 should be displayed and Genset Type GENSET should be displayed as Read only field.


Sub J20591_1

Dim ObjReeferButton,ObjTemp,ObjOnPower,ObjTempUnit,ObjGenSetID,ObjSend,ObjCommit
 Call CommonRoutines.fetchData("J20591_1")
 Call SparcsN4CommonRoutines.n4LogIn
 Call SparcsN4CommonRoutines.n4DeleteUnit("DINU1259753")
 Call SparcsN4CommonRoutines.n4DeleteAccessories("DINU857531")
 'Call CommonRoutines.GetCurrentDirectory
 'Call SparcsN4CommonRoutines.n4ImportSnxFile(CurrentDirectory+"\ScriptData\SNX\ReceiveEmptyUnit2200.xml")
 Call SparcsN4CommonRoutines.n4CreateAccessories
'' Call SparcsN4CommonRoutines.n4CreateVesselStowPlan
'' Call SparcsN4CommonRoutines.n4VesselDischarge
 
 Call SparcsN4CommonRoutines.n4AttachUnit
 Call N4MobileCommonRoutines.n4mobileLogin
 Call N4MobileCommonRoutines.n4mobileScopeSelection
 Call N4MobileCommonRoutines.n4mobileSelectProgram
 Call N4MobileYardInspectionCommonRoutines.n4mobileYardInspectionEnterContainerNumber
 Call N4MobileYardInspectionCommonRoutines.n4mobileYardInspectionEnterSeal
 Call N4MobileYardInspectionCommonRoutines.n4mobileYardInspectionEnterReeferDetails
 Delay 1000
 Set ObjReeferButton = Aliases.browser.FindChild("idStr","program:MYInspButtons-myTMPButton_input",20,True)
   'If ObjReeferButton.WaitProperty("Enabled", True,5000) Then
     Call CommonRoutines.ClickOperation(ObjReeferButton,"Reefer Button")
     Set ObjTemp = Aliases.browser.FindChild("idStr","program:MYI004-myReeferTemperature_input",20,True)
       'If ObjTemp.WaitProperty("Enabled", True,5000) Then
         Set ObjOnPower = Aliases.browser.FindChild("idStr","program:MYI004-myUnitIsPowered_input",20,True)
         Call CommonRoutines.ClickOperation(ObjOnPower,"On Power")
         ObjTemp.SetText(flowData.Item("n4YInspTemperature"))
         Set ObjTempUnit = Aliases.browser.FindChild("idStr","program:MYI004-myTemperatureUnit_input",20,True)
         ObjTempUnit.SetText(flowData.Item("n4YInspTemperatureUnit"))
         'Set ObjGenSetID = Aliases.browser.FindChild("idStr","program:MYI005-myGensetId_input",20,True)
         'ObjTempUnit.SetText(flowData.Item("n4YInspGensetID")
         Set ObjGenSetID = Aliases.browser.FindChild("idStr","program:MYI005-myGensetId_input",20,True)
         Call aqObject.CheckProperty(ObjGenSetID, "text", cmpEqual, "DINU857531")
         Set ObjGenSetType = Aliases.browser.FindChild("idStr","program:MYI005-myGensetType_input",20,True)
         Call aqObject.CheckProperty(ObjGenSetType, "text", cmpEqual, "NMGS")
         'Set ObjGenSetType = Aliases.browser.FindChild("idStr","program:MYI005-myGensetType_input",20,True)
         'Call CommonRoutines.EnterOperation(ObjGenSetType,flowData.Item("n4YInspGenSetType"),"Genset Type")
         Set ObjSend = Aliases.browser.FindChild("idStr","program:optional_2_SEND",20,True)
         Call CommonRoutines.ClickOperation(ObjSend,"Send Button")
         Set ObjCommit = Aliases.browser.FindChild("idStr","program:two_2_COMMIT",20,True)
         Call CommonRoutines.ClickOperation(ObjCommit,"Commit Button")
         aqUtils.Delay 1000
          Call N4MobileCommonRoutines.n4MobileLogout
 Call SparcsN4CommonRoutines.n4DeleteUnit("DINU1259753")
   Call SparcsN4CommonRoutines.n4DeleteAccessories("DINU857531")
 'Call SparcsN4CommonRoutines.n4Close
 Call N4MobileCommonRoutines.n4mobileCloseBrowser
  
   
  
  
  
  
 
End Sub

