'USEUNIT CommonRoutines
'USEUNIT SparcsN4CommonRoutines

'To Add Routing Point
'Input Parameters: By using Dictionary Object
'Created: 06/04/2018 
'Created by: Aswini Uthayakumar
'Reviewed:
'Reviewed by:
Sub n4AddRoutingPoint
  Dim ObjAdd,ObjPointID,ObjUNLocation,ObjActualPOD,ObjScheduleDCode,ObjScheduleKCode,ObjSPLCCode,ObjTerminal,ObjPlaceHolder,IsPlaceHolder,ObjSave,ObjRefresh,ObjSearch
  Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu.Click("Windows|Close All Tabs") 
  aqUtils.Delay 2000
  Call n4SelectWorkMode
  Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu.Click("Routing|Routing Points")
  aqUtils.Delay 2000
  Set ObjAdd = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL_ACTION_CREATE", 20, True)
  Call CommonRoutines.ClickOperation(ObjAdd,"Add Button")
  aqUtils.Delay 5000
  Set ObjPointID = Aliases.jp2launcher.n4AddRoutingPointWindow.FindChild("AWTComponentName", "pointId", 20, True)
  Call CommonRoutines.EnterOperation(ObjPointID,(flowData.Item("PointID")),"PointID")
  Set ObjUNLocation =  Aliases.jp2launcher.n4AddRoutingPointWindow.FindChild("AWTComponentName", "pointUnLoc", 20, True)
  Call CommonRoutines.EnterOperation(ObjUNLocation,(flowData.Item("UNLocationCode")),"UNLocationCode")
  Call CommonRoutines.EnterOperation(ObjUNLocation,(flowData.Item("EnterKey")),"Enter key")
  Set ObjActualPOD = Aliases.jp2launcher.n4AddRoutingPointWindow.FindChild("AWTComponentName", "pointActualPOD", 20, True)
  Call CommonRoutines.EnterOperation(ObjActualPOD,(flowData.Item("ActualPortOfDischarge")),"ActualPortOfDischarge")
  Set ObjScheduleDCode = Aliases.jp2launcher.n4AddRoutingPointWindow.FindChild("AWTComponentName", "pointScheduleDCode", 20, True)
  Call CommonRoutines.EnterOperation(ObjScheduleDCode,(flowData.Item("Dcode")),"ScheduleDCode")
  Set ObjScheduleKCode = Aliases.jp2launcher.n4AddRoutingPointWindow.FindChild("AWTComponentName", "pointScheduleKCode", 20, True)
  Call CommonRoutines.EnterOperation(ObjScheduleKCode,(flowData.Item("Kcode")),"ScheduleKCode")
  Set ObjSPLCCode = Aliases.jp2launcher.n4AddRoutingPointWindow.FindChild("AWTComponentName", "pointSplcCode", 20, True)
  Call CommonRoutines.EnterOperation(ObjSPLCCode,(flowData.Item("SPLCCodeValue")),"SPLCCode")
  Set ObjTerminal = Aliases.jp2launcher.n4AddRoutingPointWindow.FindChild("AWTComponentName", "pointTerminal", 20, True)
  Call CommonRoutines.EnterOperation(ObjTerminal,(flowData.Item("TerminalValue")),"Terminal")
  Set ObjPlaceHolder = Aliases.jp2launcher.n4AddRoutingPointWindow.FindChild("AWTComponentName", "pointIsPlaceholderPoint", 20, True)
  IsPlaceHolder = (flowData.Item("PlaceHolderValue"))
    If IsPlaceHolder = "true" Then
      Call CommonRoutines.ClickOperation(ObjPlaceHolder,"IsPlaceHolder Button")
    End If
  Set ObjSave = Aliases.jp2launcher.n4AddRoutingPointWindow.FindChild("AWTComponentName", "LABEL_ACTION_SAVE", 20, True)
  Call CommonRoutines.ClickOperation(ObjSave,"Save Button")
  Set ObjRefresh = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL_ACTION_REFRESH", 20, True)
  Call CommonRoutines.ClickOperation(ObjRefresh,"Refresh Button")
  Set ObjSearch = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL__QUICK_SEARCH", 20, True)
  Call CommonRoutines.EnterOperation(ObjSearch,(flowData.Item("PointID")),"PointID")
  Call CommonRoutines.EnterOperation(ObjSearch,(flowData.Item("EnterKey")),"Enter Key")
  Aliases.jp2launcher.FindChild("AWTComponentName", "ARG033", 20, True).selectAll
    If Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL_ACTION_EDIT", 20, True).Enabled Then
      Log.Checkpoint ("Routing Point is created Successfully")
    Else
      Log.Checkpoint ("Routing Point is not Created")
    End If
End Sub

'To Purge Routing Point
'Input Parameters: By using Dictionary Object
'Created: 06/04/2018 
'Created by: Soundarya
'Reviewed:
'Reviewed by:
Sub n4PurgeRoutingPoint
  Dim ObjSearch,ObjEdit,ObjActionsButton,ObjRefresh
  Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu.Click("Windows|Close All Tabs") 
  aqUtils.Delay 2000
  Call n4SelectWorkMode
  Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu.Click("Routing|Routing Points")
  aqUtils.Delay 2000
  Set ObjSearch = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL__QUICK_SEARCH", 20, True)
  Call CommonRoutines.EnterOperation(ObjSearch,(flowData.Item("PointID")),"PointID")
  Call CommonRoutines.EnterOperation(ObjSearch,(flowData.Item("EnterKey")),"Enter Key")
  Aliases.jp2launcher.FindChild("AWTComponentName", "ARG033", 20, True).selectAll
  Set ObjEdit = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL_ACTION_EDIT", 20, True)
    If  ObjEdit.Enabled Then
      Log.Checkpoint "Routing point is present"
    Else
      Log.Checkpoint "Routing point is not present"
    End If
  Set ObjActionsButton = Aliases.jp2launcher.FindChild("AWTComponentName", "MENU__ACTIONS", 20, True)
  Call CommonRoutines.ClickOperation(ObjActionsButton,"Actions Button")
  ObjActionsButton.SwingPopupMenu.Click("Purge")
  Set ObjRefresh = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL_ACTION_REFRESH", 20, True)
  Call CommonRoutines.ClickOperation(ObjRefresh,"Refresh Button")
    If not ObjEdit.Enabled Then
      Log.Checkpoint "Routing point Deleted successfully"
    ElseIf ObjEdit.Enabled Then
      Log.Checkpoint "Routing point already deleted"  
    End if
End Sub