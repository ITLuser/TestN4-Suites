'USEUNIT CommonRoutines

'To login N4
'Input Parameters: By using Dictionary Object
'Created: 05/04/2018 
'Created by: Aswini Uthayakumar
'Reviewed:
'Reviewed by: 
Sub n4LogIn
  aqUtils.Delay 5000
  Dim ObjUserName,ObjPassWord,ObjLoginButton,ObjAcceptSite
  If Aliases.jp2launcher.n4HomeView.Exists Then
    Log.Checkpoint("N4 is already launched")
    Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu.Click("Windows|Close All Tabs")
  Else
    Call CommonRoutines.OpenN4
    If Aliases.jp2launcher.n4Loginview.WaitProperty("Exists", True,50000) And Aliases.jp2launcher.n4Loginview.WaitProperty("Visible", True,50000) Then 
      Set ObjUserName = Aliases.jp2launcher.FindChild("AWTComponentName", "username", "20", "true")
      Call CommonRoutines.EnterOperation(ObjUserName,(flowData.Item("User Name")),"UserName")
      Set ObjPassWord = Aliases.jp2launcher.FindChild("AWTComponentName", "password", "20", "true")
      Call CommonRoutines.EnterOperation(ObjPassWord,(flowData.Item("Password")),"PassWord")
      Set ObjLoginButton = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL__LOGIN", "20", "true")
      Call CommonRoutines.ClickOperation(ObjLoginButton,"Login Button")
      aqUtils.Delay 5000
      Set ObjAcceptSite = Aliases.jp2launcher.FindChild("AWTComponentName", "ACCEPT_SITE", "20", "true")
      If ObjAcceptSite.Exists Then
        Log.Checkpoint("User is logged in successfully")
        Call n4ScopeSelection
      ElseIf not ObjAcceptSite.Exists Then
        Log.Checkpoint("User login failed")
      End If
    Else
      Log.Error("User form is not found")
    End If
  End If
End Sub

'To Select Scope
'Input Parameters: By using Dictionary Object
'Created: 05/04/2018 
'Created by: Aswini Uthayakumar
'Reviewed:
'Reviewed by:
Sub n4ScopeSelection
  Dim ObjOperator,ObjComplex,ObjFacility,ObjYard,ObjGoButton,ObjAcceptSite,ObjHomeView
  Set ObjAcceptSite = Aliases.jp2launcher.FindChild("AWTComponentName", "ACCEPT_SITE", "20", "true")
  If Aliases.jp2launcher.n4HomeView.Exists Then
    Log.Checkpoint("N4 is already launched and logged in successfully")
  Else If ObjAcceptSite.Exists Then
    Set ObjOperator = Aliases.jp2launcher.FindChild("AWTComponentName", "operator", "20", "true")
    Call CommonRoutines.EnterOperation(ObjOperator,(flowData.Item("Operator")),"Operator")
    Set ObjComplex = Aliases.jp2launcher.FindChild("AWTComponentName", "complex", "20", "true")
    Call CommonRoutines.EnterOperation(ObjComplex,(flowData.Item("Complex")),"Complex")
    Set ObjFacility = Aliases.jp2launcher.FindChild("AWTComponentName", "facility", "20", "true")
    Call CommonRoutines.EnterOperation(ObjFacility,(flowData.Item("Facility")),"Facility")
    Set ObjYard = Aliases.jp2launcher.FindChild("AWTComponentName", "yard", "20", "true")
    Call CommonRoutines.EnterOperation(ObjYard,(flowData.Item("Yard")),"Yard") 
    aqUtils.Delay 2000
    Set ObjGoButton = Aliases.jp2launcher.FindChild("AWTComponentName", "ACCEPT_SITE", "20", "true")
    Call CommonRoutines.ClickOperation(ObjGoButton,"Go Button")
    aqUtils.Delay 5000
    Set ObjHomeView = Aliases.jp2launcher.FindChild("AWTComponentName", "homeView", "20", "true")
      If ObjHomeView.Exists Then
        Log.Checkpoint("Scope is selected Successfully")
        Aliases.jp2launcher.FindChild("AWTComponentName", "homeView", "20", "true").Maximize
      ElseIf not ObjHomeView.Exists Then
        Log.Checkpoint("Scope selection failed")  
      End If
    aqUtils.Delay 5000
  ElseIf not ObjAcceptSite.Exists Then
    Log.Checkpoint("Scope selection site not found")
  End If 
  End If
End Sub

'To Select WorkMode
'Input Parameters: By using Dictionary Object
'Created: 05/04/2018 
'Created by: Aswini Uthayakumar
'Reviewed:
'Reviewed by:
Sub n4SelectWorkMode
  Dim SelWorkMode,ObjMenu,ObjOperationsMenu,ObjAdministrationMenu,ObjConfigurationMenu
  aqUtils.Delay 2000
  Set ObjMenu = Aliases.jp2launcher.FindChild("AWTComponentName", "topLevelMenu", 20, True)
  Call CommonRoutines.ClickOperation(ObjMenu,"Menu Button")
  SelWorkMode = (flowData.Item("WorkMode"))
      If SelWorkMode = "Operations" Then
        Set ObjOperationsMenu = Aliases.jp2launcher.FindChild("AWTComponentName", "NavigationId[TOP1_OPERATIONS]", 20, True)
          If ObjOperationsMenu.Enabled Then
            Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu.Click(" |Operations")
            Log.Checkpoint "Operations is selected successfully"
          ElseIf Not ObjOperationsMenu.Enabled Then
            Log.Checkpoint"Operations is already selected"
          End If
      ElseIf SelWorkMode = "Administration" Then
        aqUtils.Delay 2000
        Set ObjAdministrationMenu = Aliases.jp2launcher.FindChild("AWTComponentName", "NavigationId[TOP1_ADMINISTRATION]", 20, True)
          If ObjAdministrationMenu.Enabled Then
            Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu.Click(" |Administration")
            Log.Checkpoint "Administration is selected successfully"
          ElseIf Not ObjAdministrationMenu.Enabled Then
            Log.Checkpoint"Administration is already selected"
          End If
      ElseIf SelWorkMode = "Configuration" Then
        aqUtils.Delay 2000
        Set ObjConfigurationMenu = Aliases.jp2launcher.FindChild("AWTComponentName", "NavigationId[TOP1_CONFIGURATION]", 20, True)
          If ObjConfigurationMenu.Enabled Then
            Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu.Click(" |Configuration")
            Log.Checkpoint "Configuration is selected successfully"
          ElseIf Not ObjConfigurationMenu.Enabled Then
            Log.Checkpoint"Configuration is already selected"
          End If
      End If
End Sub

'To Add Routing Point
'Input Parameters: By using Dictionary Object
'Created: 06/04/2018 
'Created by: Aswini Uthayakumar
'Reviewed:
'Reviewed by:
Sub n4RoutingPoint
  Dim ObjAdd,ObjPointID,ObjUNLocation,ObjActualPOD,ObjScheduleDCode,ObjScheduleKCode,ObjSPLCCode,ObjTerminal,ObjPlaceHolder,IsPlaceHolder,ObjSave,ObjRefresh,ObjSearch
  Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu.Click("Windows|Close All Tabs") 
  aqUtils.Delay 2000
  Call n4SelectWorkMode
  Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu.Click("Routing|Routing Points")
  aqUtils.Delay 2000
  Set ObjAdd = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL_ACTION_CREATE", 20, True)
  Call CommonRoutines.ClickOperation(ObjAdd,"Add Button")
  aqUtils.Delay 5000
  Set ObjPointID = Aliases.jp2launcher.n4AddRoutingPointWindow.FindChild("AWTComponentName", "pointId", 20, True)
  Call CommonRoutines.EnterOperation(ObjPointID,(flowData.Item("PointID")),"PointID")
  Set ObjUNLocation =  Aliases.jp2launcher.n4AddRoutingPointWindow.FindChild("AWTComponentName", "pointUnLoc", 20, True)
  Call CommonRoutines.EnterOperation(ObjUNLocation,(flowData.Item("UNLocationCode")),"UNLocationCode")
  Set ObjActualPOD = Aliases.jp2launcher.n4AddRoutingPointWindow.FindChild("AWTComponentName", "pointActualPOD", 20, True)
  Call CommonRoutines.EnterOperation(ObjActualPOD,(flowData.Item("ActualPortOfDischarge")),"ActualPortOfDischarge")
  Set ObjScheduleDCode = Aliases.jp2launcher.n4AddRoutingPointWindow.FindChild("AWTComponentName", "pointScheduleDCode", 20, True)
  Call CommonRoutines.EnterOperation(ObjScheduleDCode,(flowData.Item("Dcode")),"ScheduleDCode")
  Set ObjScheduleKCode = Aliases.jp2launcher.n4AddRoutingPointWindow.FindChild("AWTComponentName", "pointScheduleKCode", 20, True)
  Call CommonRoutines.EnterOperation(ObjScheduleKCode,(flowData.Item("Kcode")),"ScheduleKCode")
  Set ObjSPLCCode = Aliases.jp2launcher.n4AddRoutingPointWindow.FindChild("AWTComponentName", "pointSplcCode", 20, True)
  Call CommonRoutines.EnterOperation(ObjSPLCCode,(flowData.Item("SPLCCodeValue")),"SPLCCode")
  Set ObjTerminal = Aliases.jp2launcher.n4AddRoutingPointWindow.FindChild("AWTComponentName", "pointTerminal", 20, True)
  Call CommonRoutines.EnterOperation(ObjTerminal,(flowData.Item("TerminalValue")),"Terminal")
  Set ObjPlaceHolder = Aliases.jp2launcher.n4AddRoutingPointWindow.FindChild("AWTComponentName", "pointIsPlaceholderPoint", 20, True)
  IsPlaceHolder = (flowData.Item("PlaceHolderValue"))
    If IsPlaceHolder = "true" Then
      Call CommonRoutines.ClickOperation(ObjPlaceHolder,"IsPlaceHolder Button")
    End If
  Set ObjSave = Aliases.jp2launcher.n4AddRoutingPointWindow.FindChild("AWTComponentName", "LABEL_ACTION_SAVE", 20, True)
  Call CommonRoutines.ClickOperation(ObjSave,"Save Button")
  Set ObjRefresh = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL_ACTION_REFRESH", 20, True)
  Call CommonRoutines.ClickOperation(ObjRefresh,"Refresh Button")
  Set ObjSearch = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL__QUICK_SEARCH", 20, True)
  Call CommonRoutines.EnterOperation(ObjSearch,(flowData.Item("PointID")),"PointID")
  Call CommonRoutines.EnterKey(ObjSearch)
  Aliases.jp2launcher.FindChild("AWTComponentName", "ARG033", 20, True).selectAll
    If Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL_ACTION_EDIT", 20, True).Enabled Then
      Log.Checkpoint ("Routing Point is created Successfully")
    Else
      Log.Checkpoint ("Routing Point is not Created")
    End If
End Sub

'To Purge Routing Point
'Input Parameters: By using Dictionary Object
'Created: 06/04/2018 
'Created by: Soundarya
'Reviewed:
'Reviewed by:
Sub n4PurgeRoutingPoint
  Dim ObjSearch,ObjEdit,ObjActionsButton,ObjRefresh
  Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu.Click("Windows|Close All Tabs") 
  aqUtils.Delay 2000
  Call n4SelectWorkMode
  Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu.Click("Routing|Routing Points")
  aqUtils.Delay 2000
  Set ObjSearch = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL__QUICK_SEARCH", 20, True)
  Call CommonRoutines.EnterOperation(ObjSearch,(flowData.Item("PointID")),"PointID")
  Call CommonRoutines.EnterKey(ObjSearch)
  Aliases.jp2launcher.FindChild("AWTComponentName", "ARG033", 20, True).selectAll
  Set ObjEdit = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL_ACTION_EDIT", 20, True)
    If  ObjEdit.Enabled Then
      Log.Checkpoint "Routing point is present"
    Else
      Log.Checkpoint "Routing point is not present"
    End If
  Set ObjActionsButton = Aliases.jp2launcher.FindChild("AWTComponentName", "MENU__ACTIONS", 20, True)
  Call CommonRoutines.ClickOperation(ObjActionsButton,"Actions Button")
  ObjActionsButton.SwingPopupMenu.Click("Purge")
  Set ObjRefresh = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL_ACTION_REFRESH", 20, True)
  Call CommonRoutines.ClickOperation(ObjRefresh,"Refresh Button")
    If not ObjEdit.Enabled Then
      Log.Checkpoint "Routing point Deleted successfully"
    ElseIf ObjEdit.Enabled Then
      Log.Checkpoint "Routing point already deleted"  
    End if
End Sub

'To Create Carrier Service
'Input Parameters: By using Dictionary Object
'Created: 06/04/2018 
'Created by: Aswini Uthayakumar
'Reviewed:
'Reviewed by:

Sub n4CreateCarrierService
  Dim ObjCreateService,ObjServiceID,ObjServiceName,ObjMode,CarrierMode,ObjAddPoint,ObjPoint,Port(4),ObjSaveService,ObjRefresh,ObjSearch,ObjEdit,ObjTable
  Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu.Click("Windows|Close All Tabs")
  aqUtils.Delay 2000
  Call n4SelectWorkMode
  Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu.Click("Carriers|Carrier Services")
  Set ObjCreateService = Aliases.jp2launcher.FindChild("AWTComponentName","LABEL_ACTION_CREATE",20,True)
  Call CommonRoutines.ClickOperation(ObjCreateService,"Add Button")
  Set ObjServiceID = Aliases.jp2launcher.n4AddCarrierServiceWindow.FindChild("AWTComponentName","srvcId",20,True)
  Call CommonRoutines.EnterOperation(ObjServiceID,(flowData.Item("ServiceID")),"ServiceID")
  Set ObjServiceName = Aliases.jp2launcher.n4AddCarrierServiceWindow.FindChild("AWTComponentName", "srvcName", 20, True)
  aqUtils.Delay 500
  Call CommonRoutines.EnterOperation(ObjServiceName,(flowData.Item("ServiceName")),"ServiceName")
  Set ObjMode = Aliases.jp2launcher.n4AddCarrierServiceWindow.FindChild("AWTComponentName", "srvcCarrierMode", 20, True)
  aqUtils.Delay 500
  CarrierMode = (flowData.Item("CarrierMode"))
    If CarrierMode = "Vessel" Then
        EnterMode.Keys("Vessel")
    ElseIf CarrierMode = "Train" Then
        EnterMode.Keys("Train")
    ElseIf CarrierMode = "Truck" Then
        EnterMode.Keys("Truck")
    End If
  Set ObjAddPoint = Aliases.jp2launcher.n4AddCarrierServiceWindow.FindChild("AWTComponentName", "ADD_PORT", 20, True)
  Call CommonRoutines.ClickOperation(ObjAddPoint,"AddPoint Button")
  Set ObjPoint = Aliases.jp2launcher.FindChild("AWTComponentName", "chooserLookupField", 20, True)
  Port(0)=(flowData.Item("Port1"))
  Port(1)=(flowData.Item("Port2"))
  Port(2)=(flowData.Item("Port3"))
  Port(3)=(flowData.Item("Port4"))
  Port(4)=(flowData.Item("Port5"))
  Call CommonRoutines.EnterOperation(ObjPoint,Port(0),"Port1")
  aqUtils.Delay 500
  Call CommonRoutines.EnterKey(ObjPoint)
  aqUtils.Delay 500
  Call CommonRoutines.EnterOperation(ObjPoint,Port(1),"Port2")
  aqUtils.Delay 500
  Call CommonRoutines.EnterKey(ObjPoint)
  aqUtils.Delay 500
  Call CommonRoutines.EnterOperation(ObjPoint,Port(2),"Port3")
  aqUtils.Delay 500
  Call CommonRoutines.EnterKey(ObjPoint)
  aqUtils.Delay 500
  Call CommonRoutines.EnterOperation(ObjPoint,Port(3),"Port4")
  aqUtils.Delay 500
  Call CommonRoutines.EnterKey(ObjPoint)
  aqUtils.Delay 500
  Call CommonRoutines.EnterOperation(ObjPoint,Port(4),"Port5")
  aqUtils.Delay 500
  Call CommonRoutines.EnterKey(ObjPoint)
  aqUtils.Delay 500
  Call CommonRoutines.EscapeKey(ObjPoint)
  Set ObjSaveService = Aliases.jp2launcher.n4AddCarrierServiceWindow.FindChild("AWTComponentName", "LABEL_ACTION_SAVE", 20, True)
  Call CommonRoutines.ClickOperation(ObjSaveService,"Save Button")
  Set ObjRefresh = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL_ACTION_REFRESH", 20, True)
  Call CommonRoutines.ClickOperation(ObjRefresh,"Refresh Button")
  Set ObjSearch = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL__QUICK_SEARCH", 20, True)
  Call CommonRoutines.EnterOperation(ObjSearch,(flowData.Item("ServiceID")),"ServiceID")
  Call CommonRoutines.EnterKey(ObjSearch)
  Set ObjTable = Aliases.jp2launcher.FindChild("AWTComponentName", "ARG035", 20, True)
  ObjTable.selectAll
  Set ObjEdit = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL_ACTION_EDIT", 20, True)
    If ObjEdit.Enabled Then
      Log.Checkpoint "Carrier Service Created Successfully"
    Else
      Log.Checkpoint "Carrier Service not found"
    End If
  aqUtils.Delay 1000
  Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu.Click("Windows|Close All Tabs")
End Sub

'To Purge Carrier Service
'Input Parameters: By using Dictionary Object
'Created: 06/04/2018 
'Created by: Soundarya
'Reviewed:
'Reviewed by:
Sub n4PurgeCarrierService
  Dim ObjSearch,ObjEdit,ObjActionsButton,ObjRefresh,ObjTable,ObjHomeView
  Set ObjHomeView = Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu
  ObjHomeView.Click("Windows|Close All Tabs")
  aqUtils.Delay 2000
  Call n4SelectWorkMode
  ObjHomeView.Click("Carriers|Carrier Services")
  Set  ObjSearch = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL__QUICK_SEARCH", 20, True)
  Call CommonRoutines.EnterOperation(ObjSearch,(flowData.Item("ServiceID")),"Search")
  Call CommonRoutines.EnterKey(ObjSearch)
  Set ObjTable = Aliases.jp2launcher.FindChild("AWTComponentName", "ARG035", 20, True)
  ObjTable.selectAll
  Set ObjEdit = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL_ACTION_EDIT", 20, True)
    If ObjEdit.Enabled Then
      Log.Checkpoint "Carrier Service is present"
    Else
      Log.Checkpoint "Carrier Service is not present"
    End If
  Set ObjActionsButton = Aliases.jp2launcher.FindChild("AWTComponentName", "MENU__ACTIONS", 20, True)
  Call CommonRoutines.ClickOperation(ObjActionsButton,"Actions Button")
  ObjActionsButton.SwingPopupMenu.Click("Purge")
  Set ObjRefresh = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL_ACTION_REFRESH", 20, True)
  Call CommonRoutines.ClickOperation(ObjRefresh,"Refresh Button")
    If not ObjEdit.Enabled Then
      Log.Checkpoint "Carrier service Deleted successfully"
    Else
      Log.Checkpoint "Carrier Service already deleted"  
    End if
  aqUtils.Delay 1000
  Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu.Click("Windows|Close All Tabs")
End Sub

'To Create Equipment Type
'Input Parameters: By using Dictionary Object
'Created: 11/04/2018 
'Created by: Aswini Uthayakumar
'Reviewed:
'Reviewed by:
sub n4CreatEquipmentType
  Dim ObjHomeView,ObjAdd,ObjEquipmentType,ObjGeneralClass,ObjIsoGroup,ObjNominalLength,ObjNominalHeight,ObjTareWeight,ObjSafeWeight,ObjSave,ObjRefresh,ObjQuickSearchColumn,ObjTable,ObjSearch,ObjEdit
  Set ObjHomeView = Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu
  ObjHomeView.Click("Windows|Close All Tabs")
  aqUtils.Delay 2000
  Call n4SelectWorkMode
  Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu.Click("Equipment|Equipment Types") 
  Set ObjAdd = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL_ACTION_CREATE", 20, True)
  Call CommonRoutines.ClickOperation(ObjAdd,"Add Button")
  Set ObjEquipmentType = Aliases.jp2launcher.n4AddEquipmentTypeWindow.FindChild("AWTComponentName", "eqtypId", 20, True)
  Call CommonRoutines.EnterOperation(ObjEquipmentType,(flowData.Item("EquipmentID")),"EquipmentID")
  Set ObjGeneralClass = Aliases.jp2launcher.n4AddEquipmentTypeWindow.FindChild("AWTComponentName", "eqtypClass", 20, True)
  Call CommonRoutines.EnterOperation(ObjGeneralClass,(flowData.Item("GeneralClass")),"General Class")
  Set ObjIsoGroup = Aliases.jp2launcher.n4AddEquipmentTypeWindow.FindChild("AWTComponentName", "eqtypIsoGroup", 20, True)
  Call CommonRoutines.EnterOperation(ObjIsoGroup,(flowData.Item("ISOGroup")),"ISO Group")
  Set ObjNominalLength = Aliases.jp2launcher.n4AddEquipmentTypeWindow.FindChild("AWTComponentName", "eqtypNominalLength", 20, True)
  Call CommonRoutines.EnterOperation(ObjNominalLength,(flowData.Item("NominalLength")),"Nominal Length")
  Set ObjNominalHeight = Aliases.jp2launcher.n4AddEquipmentTypeWindow.FindChild("AWTComponentName", "eqtypNominalHeight", 20, True)
  Call CommonRoutines.EnterOperation(ObjNominalHeight,(flowData.Item("NominalHeight")),"Nominal Height")
  Set ObjTareWeight = Aliases.jp2launcher.n4AddEquipmentTypeWindow.FindChild("AWTComponentName", "eqtypTareWeightKg", 20, True)
  Call CommonRoutines.EnterOperation(ObjTareWeight,(flowData.Item("TareWeight")),"Tare Weight")
  Set ObjSafeWeight = Aliases.jp2launcher.n4AddEquipmentTypeWindow.FindChild("AWTComponentName", "eqtypSafeWeightKg", 20, True)
  Call CommonRoutines.EnterOperation(ObjSafeWeight,(flowData.Item("SafeWeight")),"Safe Weight")
  Set ObjSave = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL_ACTION_SAVE", 20, True)
  Call CommonRoutines.ClickOperation(ObjSave,"Save Button")
  Set ObjRefresh = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL_ACTION_REFRESH", 20, True)
  Call CommonRoutines.ClickOperation(ObjRefresh,"Refresh Button")
  Set ObjQuickSearchColumn = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL__QUICK_SEARCH_COLUMN", 20, True)
  Call CommonRoutines.EnterOperation(ObjQuickSearchColumn,(flowData.Item("QuickSearchColumn")),"Quick Search Column")
  Set ObjSearch = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL__QUICK_SEARCH", 20, True)
  Call CommonRoutines.EnterOperation(ObjSearch,(flowData.Item("EquipmentID")),"Search")
  Call CommonRoutines.EnterKey(ObjSearch)
  Set ObjTable = Aliases.jp2launcher.FindChild("AWTComponentName", "ARG001", 20, True)
  ObjTable.selectAll
  Set ObjEdit = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL_ACTION_EDIT", 20, True)
    If ObjEdit.Enabled Then
      Log.Checkpoint ("Equipment Type is created Successfully")
    Else
      Log.Checkpoint ("Failed to create equipment type")
    End If
End Sub

'To Purge Equipment Type
'Input Parameters: By using Dictionary Object
'Created: 11/04/2018 
'Created by: Aswini Uthayakumar
'Reviewed:
'Reviewed by:
Sub n4PurgeEquipmentType
  Dim ObjHomeView,ObjQuickSearchColumn,ObjSearch,ObjTable,ObjActionsButton,ObjEdit,ObjRefresh
  Set ObjHomeView = Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu
  ObjHomeView.Click("Windows|Close All Tabs")
  aqUtils.Delay 2000
  Call n4SelectWorkMode
  Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu.Click("Equipment|Equipment Types")
  Set ObjQuickSearchColumn = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL__QUICK_SEARCH_COLUMN", 20, True)
  Call CommonRoutines.EnterOperation(ObjQuickSearchColumn,(flowData.Item("QuickSearchColumn")),"Quick Search Column")
  Set ObjSearch = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL__QUICK_SEARCH", 20, True)
  Call CommonRoutines.EnterOperation(ObjSearch,(flowData.Item("EquipmentID")),"Search")
  Call CommonRoutines.EnterKey(ObjSearch)
  Set ObjTable = Aliases.jp2launcher.FindChild("AWTComponentName", "ARG001", 20, True)
  ObjTable.selectAll
  Set ObjEdit = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL_ACTION_EDIT", 20, True)
    If ObjEdit.Enabled Then
      Log.Checkpoint ("The equipment type is found")
    Else
      Log.Checkpoint ("The equipment type is not found")
    End If
  Set ObjActionsButton = Aliases.jp2launcher.FindChild("AWTComponentName", "MENU__ACTIONS", 20, True)
  Call CommonRoutines.ClickOperation(ObjActionsButton,"Actions Button")
  ObjActionsButton.SwingPopupMenu.Click("Purge")
  Set ObjRefresh = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL_ACTION_REFRESH", 20, True)
  Call CommonRoutines.ClickOperation(ObjRefresh,"Refresh Button")
    If not ObjEdit.Enabled Then
      Log.Checkpoint "Equipment type is purged successfully"
    Else
      Log.Checkpoint "Failed to purge equipment type"  
    End if 
End Sub

'To Create EDI Trading Partner
'Input Parameters: By using Dictionary Object
'Created: 11/04/2018 
'Created by: Aswini Uthayakumar
'Reviewed:
'Reviewed by:
Sub n4EdiTradingPartner
  Dim ObjHomeView,ObjCreateTradingPartner,ObjPartnerName,ObjPartnerBusinessUnit,ObjSave,ObjRefresh,ObjSearch,ObjTable,ObjEdit
  Set ObjHomeView = Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu
  ObjHomeView.Click("Windows|Close All Tabs")
  Call n4SelectWorkMode
  ObjHomeView.Click("EDI|Trading Partners")
  Set ObjCreateTradingPartner = Aliases.jp2launcher.FindChild("AWTComponentName","LABEL_ACTION_CREATE",20,True)
  Call CommonRoutines.ClickOperation(ObjCreateTradingPartner,"Add Button")
  Set ObjPartnerName = Aliases.jp2launcher.n4AddEdiTradingPartnerWindow.FindChild("AWTComponentName","ediptnrName",20,True)
  Call CommonRoutines.EnterOperation(ObjPartnerName,(flowData.Item("EDIPartnerName")),"EDIPartnerName")
  Set ObjPartnerBusinessUnit = Aliases.jp2launcher.n4AddEdiTradingPartnerWindow.FindChild("AWTComponentName","ediptnrBusinessUnit",20,True)
  Call CommonRoutines.EnterOperation(ObjPartnerBusinessUnit,(flowData.Item("EDIPartnerBusinessUnit")),"EDIPartnerBusinessUnit")
  Call CommonRoutines.EnterKey(ObjPartnerBusinessUnit)
  Set ObjSave = Aliases.jp2launcher.n4AddEdiTradingPartnerWindow.FindChild("AWTComponentName","LABEL_ACTION_SAVE",20,True)
  Call CommonRoutines.ClickOperation(ObjSave,"Save Button")
  Set ObjRefresh = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL_ACTION_REFRESH", 20, True)
  Call CommonRoutines.ClickOperation(ObjRefresh,"Refresh Button")
  Set ObjSearch = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL__QUICK_SEARCH", 20, True)
  Call CommonRoutines.EnterOperation(ObjSearch,(flowData.Item("EDIPartnerName")),"EDIPartnerName")
  Call CommonRoutines.EnterKey(ObjSearch)
  Set ObjTable = Aliases.jp2launcher.FindChild("AWTComponentName", "EDI001", 20, True)
  ObjTable.selectAll
    Set ObjEdit = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL_ACTION_EDIT", 20, True)
    If ObjEdit.Enabled Then
      Log.Checkpoint "EDI Trading Partner Created Successfully"
    Else
      Log.Checkpoint "Failed to create EDI Trading Partner"
    End If
End Sub

'To Purge EDI Trading Partner
'Input Parameters: By using Dictionary Object
'Created: 11/04/2018 
'Created by: Aswini Uthayakumar
'Reviewed:
'Reviewed by:
Sub n4PurgeTradingPartner
  Dim ObjHomeView, ObjSearch, ObjTable, ObjEdit,ObjActionsButton,ObjRefresh
  Set ObjHomeView = Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu
  ObjHomeView.Click("Windows|Close All Tabs")
  Call n4SelectWorkMode
  ObjHomeView.Click("EDI|Trading Partners")
  Set ObjSearch = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL__QUICK_SEARCH", 20, True)
  Call CommonRoutines.EnterOperation(ObjSearch,(flowData.Item("EDIPartnerName")),"EDIPartnerName")
  Call CommonRoutines.EnterKey(ObjSearch)
  Set ObjTable = Aliases.jp2launcher.FindChild("AWTComponentName", "EDI001", 20, True)
  ObjTable.selectAll
    Set ObjEdit = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL_ACTION_EDIT", 20, True)
    If ObjEdit.Enabled Then
      Log.Checkpoint "EDI Trading Partner is found"
    Else
      Log.Checkpoint "EDI Trading Partner is not found"
    End If
  Set ObjActionsButton = Aliases.jp2launcher.FindChild("AWTComponentName", "MENU__ACTIONS", 20, True)
  Call CommonRoutines.ClickOperation(ObjActionsButton,"Actions Button")
  ObjActionsButton.SwingPopupMenu.Click("Purge")
  Set ObjRefresh = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL_ACTION_REFRESH", 20, True)
  Call CommonRoutines.ClickOperation(ObjRefresh,"Refresh Button")
    If not ObjEdit.Enabled Then
      Log.Checkpoint "EDI Trading Partner is purged successfully"
    Else
      Log.Checkpoint "Failed to purge EDI Trading Partner"  
    End if 

    
End Sub

'ToCreate Basedata for LineOperator
'Input Parameters: By using Dictionary Object
'Created: 05/04/2018 
'Created by: Dinesh RameshKumar
'Reviewed:
'Reviewed by:

Sub n4CreateLineoperator
   Dim ObjCreateLop,ObjLinename,Save,cancel,Objsearchlop,value,verify,Lineoperator,Objname,ObjScac,ObjBIC,Objlineselec
   aqUtils.Delay 2000     
   Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu.Click("Organizations|Line Operators")
   aqUtils.Delay 500
   Set ObjCreateLop =  Aliases.jp2launcher.FindChild("AWTComponentName","LABEL_ACTION_CREATE",20, True)
   Call CommonRoutines.ClickOperation(ObjCreateLop,"CreateLineoperator")
   aqUtils.Delay 2000
   Set ObjLinename = Aliases.jp2launcher.n4AddLineOperatorWindow.FindChild("AWTComponentName","bzuId",20, True)
   If ObjLinename.WaitProperty("Exists", True, 40000) Then
    ObjLinename.Keys(flowData.Item("LineOperator"))
    ObjLinename.Keys("[Tab]")
    aqUtils.Delay 500
    Set Objname = Aliases.jp2launcher.n4AddLineOperatorWindow.FindChild("AWTComponentName","bzuName",20, True)
    Call CommonRoutines.ClickOperation(Objname,"LineName")
    aqUtils.Delay 500
    Objname.Keys(flowData.Item("LineOperator_Name"))
    Objname.Keys("[Tab]")
    Set ObjScac = Aliases.jp2launcher.n4AddLineOperatorWindow.FindChild("AWTComponentName","bzuScac",20, True)
    Call CommonRoutines.ClickOperation(ObjScac,"ScacCode")
    ObjScac.Keys(flowData.Item("Scac_Code"))
    ObjScac.Keys("[Tab]")
    aqUtils.Delay 1000
    Set ObjBIC = Aliases.jp2launcher.n4AddLineOperatorWindow.FindChild("AWTComponentName","bzuBic",20, True)
    aqUtils.Delay 500
    Call CommonRoutines.EnterOperation(ObjBIC,(flowData.Item("Bic_Code")),"BicCode")
    Set Save =  Aliases.jp2launcher.n4AddLineOperatorWindow.FindChild("AWTComponentName","LABEL_ACTION_SAVE",20, True)
    Call CommonRoutines.ClickOperation(Save,"Savelineoperator")
   End If
   aqUtils.Delay 1000
   Set cancel =  Aliases.jp2launcher.n4AddLineOperatorWindow.FindChild("AWTComponentName","LABEL_ACTION_CANCEL",20, True)
   Call CommonRoutines.ClickOperation(cancel,"CancelLineoperator")
   aqUtils.Delay 2000
   Set Objsearchlop = Aliases.jp2launcher.n4HomeView.FindChild("AWTComponentName","LABEL__QUICK_SEARCH",20, True)
   Objsearchlop.Keys(flowData.Item("LineOperator_Name"))
   Objsearchlop.Keys("[Enter]")
   aqUtils.Delay 1000
   Set  Objlineselec = Aliases.jp2launcher.FindChild("AWTComponentName","ARG088",20, True)
   Objlineselec.selectAll
   aqUtils.Delay 500 
   Set edit = Aliases.jp2launcher.FindChild("AWTComponentName","LABEL_ACTION_EDIT",20, True)
   If edit.Enabled Then
    Log.Checkpoint "Line operator Successfully created" 
   Else
    Log.Error "Line operator doesnt exists"
   End If
End Sub

'To Purge Lineoperator 
'Input Parameters: By using Dictionary Object
'Created: 05/04/2018 
'Created by: Dinesh RameshKumar
'Reviewed:
'Reviewed by:
Sub n4PurgeLineop
   Dim action,Objlineselect,ObjRefresh,Objminus,Objsearchop,ObjDelete
   Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu.Click("Windows|Close All Tabs")
   Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu.Click("Organizations|Line Operators")
   aqUtils.Delay 1000
   Set Objsearchop = Aliases.jp2launcher.n4HomeView.FindChild("AWTComponentName","LABEL__QUICK_SEARCH",20, True)
   Objsearchop.Keys(flowData.Item("LineOperator"))
   Objsearchop.Keys("[Enter]")
   aqUtils.Delay 1000
   Set  Objlineselect = Aliases.jp2launcher.FindChild("AWTComponentName","ARG088",20, True)
   Objlineselect.selectAll
   aqUtils.Delay 500 
   Set Objminus =  Aliases.jp2launcher.FindChild("AWTComponentName","LABEL_ACTION_DELETE",20, True)
   If Objminus.Enabled Then
    Set action = Aliases.jp2launcher.FindChild("AWTComponentName","MENU__ACTIONS",20, True)
    action.click
    action.SwingPopupMenu.Click("Purge")
    Set ObjRefresh = Aliases.jp2launcher.FindChild("AWTComponentName","LABEL_ACTION_REFRESH",20, True)
    aqUtils.Delay 1000
    Call CommonRoutines.ClickOperation(ObjRefresh,"Refresh")
    'Set ObjDelete =  Aliases.jp2launcher.FindChild("AWTComponentName","LABEL_ACTION_DELETE",20, True)
    Log.Checkpoint  "Line operator Successfully Purged " 
   Else
    Log.Checkpoint "Line operator already Purged"
   End If
End Sub
'To DeleteLineOperator
'Input Parameters: By using Dictionary Object
'Created: 05/04/2018 
'Created by: Dinesh RameshKumar
'Reviewed:
'Reviewed by:
Sub n4DeleteLinoperator
    Dim ObjSelectall,ObjDeleteButton,Objsearchop,Objplus,ObjRefrsh
    Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu.Click("Windows|Close All Tabs")
    Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu.Click("Organizations|Line Operators")
    Set Objsearchop = Aliases.jp2launcher.n4HomeView.FindChild("AWTComponentName","LABEL__QUICK_SEARCH",20, True)
    Objsearchop.Keys(flowData.Item("LineOperator"))
    Objsearchop.Keys("[Enter]")
    aqUtils.Delay 1000
    Set  ObjSelectall = Aliases.jp2launcher.FindChild("AWTComponentName","ARG088",20, True)
    ObjSelectall.selectAll
    aqUtils.Delay 500 
    Set ObjDeleteButton =  Aliases.jp2launcher.FindChild("AWTComponentName","LABEL_ACTION_DELETE",20, True)
    If ObjDeleteButton.Enabled Then
     Set ObjDeleteButton =  Aliases.jp2launcher.FindChild("AWTComponentName","LABEL_ACTION_DELETE",20, True)
     Call CommonRoutines.ClickOperation(ObjDeleteButton,"Delete icon")
     Set Objplus =  Aliases.jp2launcher.FindChild("AWTComponentName","LABEL_YES",20, True)
     Call CommonRoutines.ClickOperation(Objplus,"Yes button")
     Set ObjRefrsh = Aliases.jp2launcher.FindChild("AWTComponentName","LABEL_ACTION_REFRESH",20, True)
     aqUtils.Delay 1000
     ObjRefrsh.Click
     Log.Checkpoint  "Line operator Successfully Deleted " 
    Else
     Log.Checkpoint "Line operator already Deleted"
    End If
End Sub

'To create truck
'Input Parameters: By using Dictionary Object
'Created: 12/04/2018 
'Created by: Aswini Uthayakumar
'Reviewed:
'Reviewed by:

Sub n4CreateTruck
  Dim ObjHomeView,ObjCreateTruck,ObjTruckID,ObjTruckLicenseNumber,ObjLicenseState,ObjLicenseExpirationDate,ObjBATNumber,ObjTagID
  Set ObjHomeView = Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu
  ObjHomeView.Click("Windows|Close All Tabs")
  Call n4SelectWorkMode
  ObjHomeView.Click("Gate|Trucks")  
  aqUtils.Delay 5000
  Set ObjCreateTruck = Aliases.jp2launcher.FindChild("AWTComponentName","LABEL_ACTION_CREATE",20,True)
  Call CommonRoutines.ClickOperation(ObjCreateTruck,"Add Button")
  Set ObjTruckID = Aliases.jp2launcher.n4AddTruckWindow.FindChild("AWTComponentName","truckId",20,True)
  Call CommonRoutines.EnterOperation(ObjTruckID,(flowData.Item("TruckID")),"Truck ID")
  Set ObjTruckLicenseNumber = Aliases.jp2launcher.n4AddTruckWindow.FindChild("AWTComponentName","truckLicenseNbr",20,True)
  Call CommonRoutines.EnterOperation(ObjTruckLicenseNumber,(flowData.Item("TruckLicense")),"Truck License")
  Set ObjLicenseState = Aliases.jp2launcher.n4AddTruckWindow.FindChild("AWTComponentName","truckLicenseState",20,True)
  Call CommonRoutines.EnterOperation(ObjLicenseState,(flowData.Item("LicenseState")),"License State")
  Set ObjLicenseExpirationDate = Aliases.jp2launcher.n4AddTruckWindow.FindChild("AWTComponentName","truckLicenseExpiration",20,True)
  Call CommonRoutines.EnterOperation(ObjLicenseExpirationDate,(flowData.Item("LicenseExpirationDate")),"License Expiration Date")
  Call CommonRoutines.TabKey(ObjLicenseExpirationDate)
  Set ObjBATNumber = Aliases.jp2launcher.n4AddTruckWindow.FindChild("AWTComponentName","truckBatNbr",20,True)
  Call CommonRoutines.EnterOperation(ObjBATNumber,(flowData.Item("BatNumber")),"BAT Number")
  IsInternalTruck = (flowData.Item("IsInternal"))
    If IsInternalTruck = "yes" Then
      Set ObjInternal= Aliases.jp2launcher.n4AddTruckWindow.FindChild("AWTComponentName", "truckIsInternal", 20, True)
      Call CommonRoutines.ClickOperation(ObjInternal,"Is Internal CheckBox")
    End If
  Set ObjTagID = Aliases.jp2launcher.n4AddTruckWindow.FindChild("AWTComponentName","truckAeiTagId",20,True)
  Call CommonRoutines.EnterOperation(ObjTagID,(flowData.Item("TagID")),"Tag ID")
  Set ObjTareWeight = Aliases.jp2launcher.n4AddTruckWindow.FindChild("AWTComponentName","truckTareWeight",20,True)
  Call CommonRoutines.EnterOperation(ObjTareWeight,(flowData.Item("TareWeight")),"Tare Weight")
  Set ObjSafeWeight = Aliases.jp2launcher.n4AddTruckWindow.FindChild("AWTComponentName","truckSafeWeight",20,True)
  Call CommonRoutines.EnterOperation(ObjSafeWeight,(flowData.Item("SafeWeight")),"Safe Weight")
  Set ObjStatus = Aliases.jp2launcher.n4AddTruckWindow.FindChild("AWTComponentName","truckStatus",20,True)
  Call CommonRoutines.EnterOperation(ObjStatus,(flowData.Item("TruckStatus")),"Truck Status")
  Set ObjLastTruckingCompany = Aliases.jp2launcher.n4AddTruckWindow.FindChild("AWTComponentName","truckTrkCo",20,True)
  Call CommonRoutines.EnterOperation(ObjLastTruckingCompany,(flowData.Item("LastTruckingCompany")),"Last Trucking Company")
  Set ObjLastTruckDriver = Aliases.jp2launcher.n4AddTruckWindow.FindChild("AWTComponentName","truckDriver",20,True)
  Call CommonRoutines.EnterOperation(ObjLastTruckDriver,(flowData.Item("LastTruckDriver")),"Last Truck Driver")
  Set ObjSave = Aliases.jp2launcher.n4AddTruckWindow.FindChild("AWTComponentName","LABEL_ACTION_SAVE",20,True)
  Call CommonRoutines.ClickOperation(ObjSave,"Save Button")
    If Aliases.jp2launcher.FindChild("AWTComponentName", "ERROR__VALIDATION_ERROR", 20, True).Exists Then
      Set ObjOk = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL_ACTION_OK", 20, True)
      Call CommonRoutines.ClickOperation(ObjOk,"OK button")
    End If
  Set ObjRefresh = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL_ACTION_REFRESH", 20, True)
  Call CommonRoutines.ClickOperation(ObjRefresh,"Refresh Button")
  Set ObjSearch = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL__QUICK_SEARCH", 20, True)
  Call CommonRoutines.EnterOperation(ObjSearch,(flowData.Item("TruckID")),"Search")
  Call CommonRoutines.EnterKey(ObjSearch)
  Set ObjTable = Aliases.jp2launcher.FindChild("AWTComponentName", "ROD025", 20, True)
  ObjTable.selectAll
  Set ObjEdit = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL_ACTION_EDIT", 20, True)
    If ObjEdit.Enabled Then
      Log.Checkpoint "Truck is Created Successfully"
    Else
      Log.Checkpoint "Failed to create Truck"
    End If
End Sub

'To Purge Truck
'Input Parameters: By using Dictionary Object
'Created: 12/04/2018 
'Created by: Aswini Uthayakumar
'Reviewed:
'Reviewed by:
Sub n4PurgeTruck
  Dim ObjHomeView,ObjQuickSearchColumn,ObjSearch,ObjTable,ObjActionsButton,ObjEdit,ObjRefresh
  Set ObjHomeView = Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu
  ObjHomeView.Click("Windows|Close All Tabs")
  aqUtils.Delay 2000
  Call n4SelectWorkMode
  Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu.Click("Gate|Trucks")
  Set ObjQuickSearchColumn = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL__QUICK_SEARCH_COLUMN", 20, True)
  Call CommonRoutines.EnterOperation(ObjQuickSearchColumn,(flowData.Item("QuickSearchColumn")),"Quick Search Column")
  Set ObjSearch = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL__QUICK_SEARCH", 20, True)
  Call CommonRoutines.EnterOperation(ObjSearch,(flowData.Item("TruckID")),"Search")
  Call CommonRoutines.EnterKey(ObjSearch)
  Set ObjTable = Aliases.jp2launcher.FindChild("AWTComponentName", "ROD025", 20, True)
  ObjTable.selectAll
  Set ObjEdit = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL_ACTION_EDIT", 20, True)
    If ObjEdit.Enabled Then
      Log.Checkpoint ("The Truck is found")
    Else
      Log.Checkpoint ("The Truck is not found")
    End If
  Set ObjActionsButton = Aliases.jp2launcher.FindChild("AWTComponentName", "MENU__ACTIONS", 20, True)
  Call CommonRoutines.ClickOperation(ObjActionsButton,"Actions Button")
  ObjActionsButton.SwingPopupMenu.Click("Purge")
  Set ObjRefresh = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL_ACTION_REFRESH", 20, True)
  Call CommonRoutines.ClickOperation(ObjRefresh,"Refresh Button")
    If not ObjEdit.Enabled Then
      Log.Checkpoint "Truck is purged successfully"
    Else
      Log.Checkpoint "Failed to purge Truck"  
    End if 
End Sub

'To Create Driver
'Input Parameters: By using Dictionary Object
'Created: 13/04/2018 
'Created by: Aswini Uthayakumar
'Reviewed:
'Reviewed by:
Sub n4CreateDriver
  Dim ObjHomeView,ObjCreateDriver,ObjDriverName,ObjDriverStatus,ObjDriverSuspendedDate,ObjDriverCardID,ObjCardExpiration,ObjDriverLicense,ObjDriverLicenseState,ObjCallUpID,ObjDriverBirthDate,ObjDriverEmailAddress,ObjHazardLicensed,ObjHazardLicenseNumber,ObjHazardLicenseExpiration,ObjDriverCheLogon,ObjInternalDriver,ObjSave,ObjCancel,ObjRefresh
  Set ObjHomeView = Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu
  ObjHomeView.Click("Windows|Close All Tabs")
  Call n4SelectWorkMode
  ObjHomeView.Click("Gate|Drivers") 
    If Aliases.jp2launcher.FindChild("AWTComponentName","LABEL_ACTION_CREATE",20,True).WaitProperty("Visible", True,50000)Then
      Set ObjCreateDriver = Aliases.jp2launcher.FindChild("AWTComponentName","LABEL_ACTION_CREATE",20,True)
      Call CommonRoutines.ClickOperation(ObjCreateDriver,"Add Button")
      Set ObjDriverName = Aliases.jp2launcher.n4AddDriverWindow.FindChild("AWTComponentName","driverName",20,True)
      Call CommonRoutines.EnterOperation(ObjDriverName,(flowData.Item("DriverName")),"Driver Name")
      Set ObjDriverStatus = Aliases.jp2launcher.n4AddDriverWindow.FindChild("AWTComponentName","driverStatus",20,True)
      Call CommonRoutines.EnterOperation(ObjDriverStatus,(flowData.Item("DriverStatus")),"Driver Status")
      Set ObjDriverSuspendedDate = Aliases.jp2launcher.n4AddDriverWindow.FindChild("AWTComponentName","driverSuspended",20,True)
      Call CommonRoutines.EnterOperation(ObjDriverSuspendedDate,(flowData.Item("DriverSuspendedDate")),"Driver Suspended Date")
      Call CommonRoutines.TabKey(ObjDriverSuspendedDate) 
      Set ObjDriverCardID = Aliases.jp2launcher.n4AddDriverWindow.FindChild("AWTComponentName","driverCardId",20,True)
      Call CommonRoutines.EnterOperation(ObjDriverCardID,(flowData.Item("DriverCardID")),"Driver Card ID")
      Set ObjCardExpiration = Aliases.jp2launcher.n4AddDriverWindow.FindChild("AWTComponentName","driverCardExpiration",20,True)
      Call CommonRoutines.EnterOperation(ObjCardExpiration,(flowData.Item("DriverCardExpirationDate")),"Driver Card Expiration Date")
      Set ObjDriverLicense = Aliases.jp2launcher.n4AddDriverWindow.FindChild("AWTComponentName","driverLicenseNbr",20,True)
      Call CommonRoutines.EnterOperation(ObjDriverLicense,(flowData.Item("DriverLicense")),"Driver License") 
      Set ObjDriverLicenseState = Aliases.jp2launcher.n4AddDriverWindow.FindChild("AWTComponentName","driverLicenseState",20,True)
      Call CommonRoutines.EnterOperation(ObjDriverLicenseState,(flowData.Item("DriverLicenseState")),"Driver License State") 
      Set ObjCallUpID = Aliases.jp2launcher.n4AddDriverWindow.FindChild("AWTComponentName","driverBatNbr",20,True)
      Call CommonRoutines.EnterOperation(ObjCallUpID,(flowData.Item("CallupID")),"Driver CallUp ID")
      Set ObjDriverBirthDate = Aliases.jp2launcher.n4AddDriverWindow.FindChild("AWTComponentName","driverBirthDate",20,True)
      aqUtils.Delay 5000
      Call CommonRoutines.EnterOperation(ObjDriverBirthDate,(flowData.Item("DriverBirthDate")),"Driver Birth Date")
      Set ObjDriverEmailAddress = Aliases.jp2launcher.n4AddDriverWindow.FindChild("AWTComponentName","driverEmailAddress",20,True)
      Call CommonRoutines.EnterOperation(ObjDriverEmailAddress,(flowData.Item("DriverEmail")),"Driver Email Address")
      IsHazardLicensed = (flowData.Item("IsHazardLicensed"))
        If IsHazardLicensed = "yes" Then
          Set ObjHazardLicensed= Aliases.jp2launcher.n4AddDriverWindow.FindChild("AWTComponentName", "driverIsHazardLicensed", 20, True)
          Call CommonRoutines.ClickOperation(ObjHazardLicensed,"Is Hazard Licensed CheckBox")
          Set ObjHazardLicenseNumber = Aliases.jp2launcher.n4AddDriverWindow.FindChild("AWTComponentName","driverHazLicenseNbr",20,True)
          Call CommonRoutines.EnterOperation(ObjHazardLicenseNumber,(flowData.Item("HazardLicenseNumber")),"Driver Hazard License Number")
          Set ObjHazardLicenseExpiration = Aliases.jp2launcher.n4AddDriverWindow.FindChild("AWTComponentName","driverHazLicenseExp",20,True)
          Call CommonRoutines.EnterOperation(ObjHazardLicenseExpiration,(flowData.Item("HazardLicenseExpirationDate")),"Driver Hazard License Expiration Date")      
        End If
      Set ObjDriverCheLogon = Aliases.jp2launcher.n4AddDriverWindow.FindChild("AWTComponentName","driverCheLogonId",20,True)
      Call CommonRoutines.EnterOperation(ObjDriverCheLogon,(flowData.Item("DriverCheLogon")),"Driver Che logon")
      IsInternalDriver = (flowData.Item("IsInternalDriver"))
        If IsInternalDriver = "yes" Then
          Set ObjInternalDriver= Aliases.jp2launcher.n4AddTruckWindow.FindChild("AWTComponentName", "driverIsInternal", 20, True)
          Call CommonRoutines.ClickOperation(ObjInternalDriver,"Is Internal Driver CheckBox")      
        End If
      Set ObjSave  = Aliases.jp2launcher.n4AddDriverWindow.FindChild("AWTComponentName","LABEL_ACTION_SAVE",20,True)
      Call CommonRoutines.ClickOperation(ObjSave,"Save Button")
      Set ObjCancel = Aliases.jp2launcher.n4AddDriverWindow.FindChild("AWTComponentName","LABEL_ACTION_CANCEL",20,True)
      Call CommonRoutines.ClickOperation(ObjCancel,"Cancel Button")   
      Set ObjRefresh  = Aliases.jp2launcher.FindChild("AWTComponentName","LABEL_ACTION_REFRESH",20,True)
      Call CommonRoutines.ClickOperation(ObjRefresh,"Refresh Button")   
      Set ObjSearch  = Aliases.jp2launcher.FindChild("AWTComponentName","LABEL__QUICK_SEARCH",20,True)
      Call CommonRoutines.EnterOperation(ObjSearch,(flowData.Item("DriverName")),"Search")
      Call CommonRoutines.EnterKey(ObjSearch)
      Set ObjTable = Aliases.jp2launcher.FindChild("AWTComponentName","ROD029",20,True)
      ObjTable.selectAll
      Set ObjEdit = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL_ACTION_EDIT", 20, True)
        If ObjEdit.Enabled Then
          Log.Checkpoint "Truck Driver is Created Successfully"
        Else
          Log.Checkpoint "Failed to create Truck Driver"
        End If
      TruckingCoAgreemenent = (flowData.Item("TruckingCoAgreement"))
        If TruckingCoAgreemenent = "yes" Then
          Call CommonRoutines.ClickOperation(ObjEdit,"Edit Button") 
          Set ObjAddTruckingCo = Aliases.jp2launcher.n4AddDriverWindow.FindChild("AWTComponentName", "LABEL_ACTION_CREATE", 20, True)
            If ObjAddTruckingCo.Enabled Then
              Call CommonRoutines.ClickOperation(ObjAddTruckingCo,"Associate Trucking Company Button") 
              Set ObjTruckingCo = Aliases.jp2launcher.n4AddTruckingCompanyInDriverWindow.FindChild("AWTComponentName", "trkcdrvTrkCo", 20, True)
              Call CommonRoutines.EnterOperation(ObjTruckingCo,(flowData.Item("TruckingCompanyId")),"Trucking Company")
              Call CommonRoutines.TabKey(ObjTruckingCo)
              Set ObjTruckingCoAgreementExpiration = Aliases.jp2launcher.n4AddTruckingCompanyInDriverWindow.FindChild("AWTComponentName", "trkcDriverExpiration", 20, True)
              Call CommonRoutines.EnterOperation(ObjTruckingCoAgreementExpiration,(flowData.Item("TruckingCompanyAgreementExpiration")),"Trucking Company Agreement expiration")
              Set ObjSave = Aliases.jp2launcher.n4AddTruckingCompanyInDriverWindow.FindChild("AWTComponentName", "LABEL_ACTION_SAVE", 20, True)
              Call CommonRoutines.ClickOperation(ObjSave,"Save Button")
              Set ObjRefresh  = Aliases.jp2launcher.n4AddDriverWindow.FindChild("AWTComponentName","LABEL_ACTION_REFRESH",20,True)
              Call CommonRoutines.ClickOperation(ObjRefresh,"Refresh Button")
              Set ObjAgreementTable  = Aliases.jp2launcher.n4AddDriverWindow.FindChild("AWTComponentName","ROD040",20,True)
              ObjAgreementTable.selectAll
              Set ObjEdit = Aliases.jp2launcher.n4AddDriverWindow.FindChild("AWTComponentName", "LABEL_ACTION_EDIT", 20, True)
                If ObjEdit.Enabled Then
                  Log.Checkpoint "Truck Driver and Trucking Company is associated successfully"
                Else
                  Log.Checkpoint "Failed to Associate Trucking Company and Driver"
                End If
              Set ObjCancel = Aliases.jp2launcher.n4AddDriverWindow.FindChild("AWTComponentName","LABEL_ACTION_CANCEL",20,True)
              Call CommonRoutines.ClickOperation(ObjCancel,"Cancel Button") 
            End If      
        End If
    End If
End Sub

'To Purge Driver
'Input Parameters: By using Dictionary Object
'Created: 13/04/2018 
'Created by: Aswini Uthayakumar
'Reviewed:
'Reviewed by:
Sub n4PurgeDriver
  Dim ObjHomeView,ObjQuickSearchColumn,ObjSearch,ObjTable,ObjActionsButton,ObjEdit,ObjRefresh
  Set ObjHomeView = Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu
  ObjHomeView.Click("Windows|Close All Tabs")
  aqUtils.Delay 2000
  Call n4SelectWorkMode
  Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu.Click("Gate|Drivers")
  Set ObjQuickSearchColumn = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL__QUICK_SEARCH_COLUMN", 20, True)
  Call CommonRoutines.EnterOperation(ObjQuickSearchColumn,(flowData.Item("QuickSearchColumn")),"Quick Search Column")
  Set ObjSearch = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL__QUICK_SEARCH", 20, True)
  Call CommonRoutines.EnterOperation(ObjSearch,(flowData.Item("DriverName")),"Search")
  Call CommonRoutines.EnterKey(ObjSearch)
  Set ObjTable = Aliases.jp2launcher.FindChild("AWTComponentName", "ROD029", 20, True)
  ObjTable.selectAll
  Set ObjEdit = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL_ACTION_EDIT", 20, True)
    If ObjEdit.Enabled Then
      Log.Checkpoint ("The Driver is found")
    Else
      Log.Checkpoint ("The Driver not found")
    End If
  Set ObjActionsButton = Aliases.jp2launcher.FindChild("AWTComponentName", "MENU__ACTIONS", 20, True)
  Call CommonRoutines.ClickOperation(ObjActionsButton,"Actions Button")
  ObjActionsButton.SwingPopupMenu.Click("Purge")
  Set ObjRefresh = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL_ACTION_REFRESH", 20, True)
  Call CommonRoutines.ClickOperation(ObjRefresh,"Refresh Button")
    If not ObjEdit.Enabled Then
      Log.Checkpoint "Driver is purged successfully"
    Else
      Log.Checkpoint "Failed to purge Driver"  
    End if 
End Sub

'To Delete Driver
'Input Parameters: By using Dictionary Object
'Created: 16/04/2018 
'Created by: Soundarya
'Reviewed:
'Reviewed by:
Sub n4DeleteDriver
  Dim ObjHomeView,ObjQuickSearchColumn,ObjSearch,ObjTable,ObjActionsButton,ObjEdit,ObjRefresh
  Set ObjHomeView = Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu
  ObjHomeView.Click("Windows|Close All Tabs")
  aqUtils.Delay 2000
  Call n4SelectWorkMode
  Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu.Click("Gate|Drivers")
  Set ObjQuickSearchColumn = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL__QUICK_SEARCH_COLUMN", 20, True)
  Call CommonRoutines.EnterOperation(ObjQuickSearchColumn,(flowData.Item("QuickSearchColumn")),"Quick Search Column")
  Set ObjSearch = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL__QUICK_SEARCH", 20, True)
  Call CommonRoutines.EnterOperation(ObjSearch,(flowData.Item("DriverName")),"Search")
  Call CommonRoutines.EnterKey(ObjSearch)
  Set ObjTable = Aliases.jp2launcher.FindChild("AWTComponentName", "ROD029", 20, True)
  ObjTable.selectAll
  Set ObjEdit = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL_ACTION_EDIT", 20, True)
  Set ObjDeleteButton = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL_ACTION_DELETE", 20, True)
  Call CommonRoutines.ClickOperation(ObjDeleteButton,"Delete button")
  Set objDeleteDialogBox= Aliases.jp2launcher.FindChild("AWTComponentName","optionDialog",20,True)
   If ObjDeleteDialogBox.Enabled Then
      Log.Checkpoint("Delete dialog box found")
    Else
      Log.Checkpoint ("Delete dialog box not found")
    End If
  Set ObjDeleteYes = Aliases.jp2launcher.FindChild("AWTComponentName","LABEL_YES",20,True)
  Call CommonRoutines.ClickOperation(ObjDeleteYes,"Delete- yes button")
  Set ObjRefresh = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL_ACTION_REFRESH", 20, True)
  Call CommonRoutines.ClickOperation(ObjRefresh,"Refresh Button")
    If not ObjEdit.Enabled Then
      Log.Checkpoint "Driver is deleted successfully"
    Else
      Log.Checkpoint "Failed to delete Driver"  
    End if 
End Sub

'To Create Trucking Company
'Input Parameters: By using Dictionary Object
'Created: 16/04/2018 
'Created by: Aswini Uthayakumar
'Reviewed:
'Reviewed by:
Sub n4CreateTruckingCompany
  Set ObjHomeView = Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu
  ObjHomeView.Click("Windows|Close All Tabs")
  Call n4SelectWorkMode
  Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu.Click("Organizations|Trucking Companies")
  If Aliases.jp2launcher.FindChild("AWTComponentName","LABEL_ACTION_CREATE",20,True).WaitProperty("Visible", True,50000)Then
    Set ObjCreateTruckingCompany = Aliases.jp2launcher.FindChild("AWTComponentName","LABEL_ACTION_CREATE",20,True)
    Call CommonRoutines.ClickOperation(ObjCreateTruckingCompany,"Add Button")
    Set ObjTruckingCompanyID = Aliases.jp2launcher.n4AddTruckingCompanyWindow.FindChild("AWTComponentName","bzuId",20,True)
    Call CommonRoutines.EnterOperation(ObjTruckingCompanyID,(flowData.Item("TruckingCompanyID")),"Trucking Company ID")
    Set ObjTruckingCompanyName = Aliases.jp2launcher.n4AddTruckingCompanyWindow.FindChild("AWTComponentName","bzuName",20,True)
    Call CommonRoutines.EnterOperation(ObjTruckingCompanyName,(flowData.Item("TruckingCompanyName")),"Trucking Company Name")
    Set ObjSCACcode = Aliases.jp2launcher.n4AddTruckingCompanyWindow.FindChild("AWTComponentName","bzuScac",20,True)
    Call CommonRoutines.EnterOperation(ObjSCACcode,(flowData.Item("TruckingCoSCACCode")),"Trucking Company SCAC Code")
    IsOperator = (flowData.Item("IsOperator"))
      If IsOperator = "yes" Then
        Set ObjIsOperator= Aliases.jp2launcher.n4AddDriverWindow.FindChild("AWTComponentName", "bzuIsEqOperator", 20, True)
        Call CommonRoutines.ClickOperation(ObjIsOperator,"Is Operator CheckBox")      
      End If
    Set ObjBICcode = Aliases.jp2launcher.n4AddTruckingCompanyWindow.FindChild("AWTComponentName","bzuBic",20,True)
    Call CommonRoutines.EnterOperation(ObjBICcode,(flowData.Item("TruckingCoBICCode")),"Trucking Company BIC Code")
    IsOwner = (flowData.Item("IsOwner"))
      If IsOwner = "yes" Then
        Set ObjIsOwner = Aliases.jp2launcher.n4AddDriverWindow.FindChild("AWTComponentName", "bzuIsEqOwner", 20, True)
        Call CommonRoutines.ClickOperation(ObjIsOwner,"Is Owner CheckBox")      
      End If
    Set ObjCreditStatus = Aliases.jp2launcher.n4AddTruckingCompanyWindow.FindChild("AWTComponentName","bzuCreditStatus",20,True)
    Call CommonRoutines.EnterOperation(ObjCreditStatus,(flowData.Item("TruckingCoCreditStatus")),"Trucking Company Credit status")
    Set ObjInsuranceExpirationDate = Aliases.jp2launcher.n4AddTruckingCompanyWindow.FindChild("AWTComponentName","trkcInsuranceExpiration",20,True)
    Call CommonRoutines.EnterOperation(ObjInsuranceExpirationDate,(flowData.Item("TruckingCoInsuranceExpirationDate")),"Trucking Company Insurance Expiration Date")
    Set ObjDefaultEDO = Aliases.jp2launcher.n4AddTruckingCompanyWindow.FindChild("AWTComponentName","trkcDefaultEdo",20,True)
    Call CommonRoutines.EnterOperation(ObjDefaultEDO,(flowData.Item("TruckingCoDefaultEDO")),"Trucking Company Default EDO")
    Set ObjContactName = Aliases.jp2launcher.n4AddTruckingCompanyWindow.FindChild("AWTComponentName","bzuCtct.ctctName",20,True)
    Call CommonRoutines.EnterOperation(ObjContactName,(flowData.Item("TruckingCoContactName")),"Trucking Company Contact Name")
    Set ObjContactAddress = Aliases.jp2launcher.n4AddTruckingCompanyWindow.FindChild("AWTComponentName","bzuCtct.ctctEmailAddress",20,True)
    Call CommonRoutines.EnterOperation(ObjContactAddress,(flowData.Item("TruckingCoContactAddresss")),"Trucking Company Contact Address")
    Set ObjContactAddressLine1 = Aliases.jp2launcher.n4AddTruckingCompanyWindow.FindChild("AWTComponentName","bzuCtct.ctctAddressLine1",20,True)
    Call CommonRoutines.EnterOperation(ObjContactAddressLine1,(flowData.Item("TruckingCoContactAddresssLine1")),"Trucking Company Contact Address Line1")
    Set ObjContactAddressLine2 = Aliases.jp2launcher.n4AddTruckingCompanyWindow.FindChild("AWTComponentName","bzuCtct.ctctAddressLine2",20,True)
    Call CommonRoutines.EnterOperation(ObjContactAddressLine2,(flowData.Item("TruckingCoContactAddresssLine2")),"Trucking Company Contact Address Line2")
    Set ObjContactAddressLine3 = Aliases.jp2launcher.n4AddTruckingCompanyWindow.FindChild("AWTComponentName","bzuCtct.ctctAddressLine3",20,True)
    Call CommonRoutines.EnterOperation(ObjContactAddressLine3,(flowData.Item("TruckingCoContactAddresssLine3")),"Trucking Company Contact Address Line3")
    Set ObjContactCity = Aliases.jp2launcher.n4AddTruckingCompanyWindow.FindChild("AWTComponentName","bzuCtct.ctctCity",20,True)
    Call CommonRoutines.EnterOperation(ObjContactCity,(flowData.Item("TruckingCoContactCity")),"Trucking Company Contact City")
    Set ObjGuaranteeLimit = Aliases.jp2launcher.n4AddTruckingCompanyWindow.FindChild("AWTComponentName","bzuPerUnitGuaranteeLimit",20,True)
    Call CommonRoutines.EnterOperation(ObjGuaranteeLimit,(flowData.Item("TruckingCoGuaranteeLimit")),"Trucking Company Guarantee Limit")
    Set ObjContactCountry = Aliases.jp2launcher.n4AddTruckingCompanyWindow.FindChild("AWTComponentName","bzuCtct.ctctCountry",20,True)
    Call CommonRoutines.EnterOperation(ObjContactCountry,(flowData.Item("TruckingCoContactCountry")),"Trucking Company Contact Country")        
    Set ObjContactState = Aliases.jp2launcher.n4AddTruckingCompanyWindow.FindChild("AWTComponentName","bzuCtct.ctctState",20,True)
    Call CommonRoutines.EnterOperation(ObjContactState,(flowData.Item("TruckingCoContactState")),"Trucking Company Contact State")
    Set ObjContactTelePhone = Aliases.jp2launcher.n4AddTruckingCompanyWindow.FindChild("AWTComponentName","bzuCtct.ctctTel",20,True)
    Call CommonRoutines.EnterOperation(ObjContactTelePhone,(flowData.Item("TruckingCoContactTelePhone")),"Trucking Company Contact TelePhone")
    
        
    
  End If

End Sub
Sub Play
  Call CommonRoutines.fetchData("SparcsN4CommonRoutines")
  'Log.Message flowData.Item("DriverCardExpirationDate")
  'Call n4CreateTruck
  'Call n4PurgeTruck
  'Call n4CreateDriver
  'Call n4PurgeDriver
  'Call n4DeleteDriver
  Call n4CreateTruckingCompany
End Sub

