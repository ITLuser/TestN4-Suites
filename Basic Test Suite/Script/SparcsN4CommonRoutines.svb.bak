'USEUNIT CommonRoutines

'To login N4
'Input Parameters: By using Dictionary Object
'Created: 05/04/2018 
'Created by: Aswini Uthayakumar
'Reviewed:
'Reviewed by: 
Sub n4LogIn
  Dim ObjUserName,ObjPassWord,ObjLoginButton,ObjAcceptSite
  If Aliases.jp2launcher.n4HomeView.Exists Then
    Log.Checkpoint("N4 is already launched")
    Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu.Click("Windows|Close All Tabs")
  Else
    Call n4Open
    If Aliases.jp2launcher.n4Loginview.WaitProperty("Exists", True,50000) And Aliases.jp2launcher.n4Loginview.WaitProperty("Visible", True,50000) Then 
      Set ObjUserName = Aliases.jp2launcher.FindChild("AWTComponentName", "username", "20", "true")
      Call CommonRoutines.EnterOperation(ObjUserName,(flowData.Item("User Name")),"UserName")
      Set ObjPassWord = Aliases.jp2launcher.FindChild("AWTComponentName", "password", "20", "true")
      Call CommonRoutines.EnterOperation(ObjPassWord,(flowData.Item("Password")),"PassWord")
      Set ObjLoginButton = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL__LOGIN", "20", "true")
      Call CommonRoutines.ClickOperation(ObjLoginButton,"Login Button")
      aqUtils.Delay 2000
      Set ObjAcceptSite = Aliases.jp2launcher.FindChild("AWTComponentName", "ACCEPT_SITE", "20", "true")
      If ObjAcceptSite.Exists Then
        Log.Checkpoint("User is logged in successfully")
        Call n4ScopeSelection
      ElseIf not ObjAcceptSite.Exists Then
        Log.Checkpoint("User login failed")
      End If
    Else
      Log.Error("User form is not found")
    End If
  End If
End Sub

'To Select Scope
'Input Parameters: By using Dictionary Object
'Created: 05/04/2018 
'Created by: Aswini Uthayakumar
'Reviewed:
'Reviewed by:
Sub n4ScopeSelection
  Dim ObjOperator,ObjComplex,ObjFacility,ObjYard,ObjGoButton,ObjAcceptSite,ObjHomeView
  Set ObjAcceptSite = Aliases.jp2launcher.FindChild("AWTComponentName", "ACCEPT_SITE", "20", "true")
  If Aliases.jp2launcher.n4HomeView.Exists Then
    Log.Checkpoint("N4 is already launched and logged in successfully")
  Else If ObjAcceptSite.Exists Then
    Set ObjOperator = Aliases.jp2launcher.FindChild("AWTComponentName", "operator", "20", "true")
    Call CommonRoutines.EnterOperation(ObjOperator,(flowData.Item("Operator")),"Operator")
    Set ObjComplex = Aliases.jp2launcher.FindChild("AWTComponentName", "complex", "20", "true")
    Call CommonRoutines.EnterOperation(ObjComplex,(flowData.Item("Complex")),"Complex")
    Set ObjFacility = Aliases.jp2launcher.FindChild("AWTComponentName", "facility", "20", "true")
    Call CommonRoutines.EnterOperation(ObjFacility,(flowData.Item("Facility")),"Facility")
    Set ObjYard = Aliases.jp2launcher.FindChild("AWTComponentName", "yard", "20", "true")
    Call CommonRoutines.EnterOperation(ObjYard,(flowData.Item("Yard")),"Yard") 
    aqUtils.Delay 2000
    Set ObjGoButton = Aliases.jp2launcher.FindChild("AWTComponentName", "ACCEPT_SITE", "20", "true")
    Call CommonRoutines.ClickOperation(ObjGoButton,"Go Button")
    aqUtils.Delay 2000
    Set ObjHomeView = Aliases.jp2launcher.FindChild("AWTComponentName", "homeView", "20", "true")
      If ObjHomeView.Exists Then
        Log.Checkpoint("Scope is selected Successfully")
        Aliases.jp2launcher.FindChild("AWTComponentName", "homeView", "20", "true").Maximize
      ElseIf not ObjHomeView.Exists Then
        Log.Checkpoint("Scope selection failed")  
      End If
    aqUtils.Delay 5000
  ElseIf not ObjAcceptSite.Exists Then
    Log.Checkpoint("Scope selection site not found")
  End If 
  End If
End Sub

'To Select WorkMode
'Input Parameters: By using Dictionary Object
'Created: 05/04/2018 
'Created by: Aswini Uthayakumar
'Reviewed:
'Reviewed by:
Sub n4SelectWorkMode(WorkMode)
  Dim SelWorkMode,ObjMenu,ObjOperationsMenu,ObjAdministrationMenu,ObjConfigurationMenu
  Set ObjMenu = Aliases.jp2launcher.FindChild("AWTComponentName", "topLevelMenu", 20, True)
  Call CommonRoutines.ClickOperation(ObjMenu,"Menu Button")
  SelWorkMode = WorkMode
      If SelWorkMode = "Operations" Then
        Set ObjOperationsMenu = Aliases.jp2launcher.FindChild("AWTComponentName", "NavigationId[TOP1_OPERATIONS]", 20, True)
          If ObjOperationsMenu.Enabled Then
            Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu.Click(" |Operations")
            Log.Checkpoint "Operations is selected successfully"
          ElseIf Not ObjOperationsMenu.Enabled Then
            Log.Checkpoint"Operations is already selected"
          End If
      ElseIf SelWorkMode = "Administration" Then
        aqUtils.Delay 1000
        Set ObjAdministrationMenu = Aliases.jp2launcher.FindChild("AWTComponentName", "NavigationId[TOP1_ADMINISTRATION]", 20, True)
          If ObjAdministrationMenu.Enabled Then
            Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu.Click(" |Administration")
            Log.Checkpoint "Administration is selected successfully"
          ElseIf Not ObjAdministrationMenu.Enabled Then
            Log.Checkpoint"Administration is already selected"
          End If
      ElseIf SelWorkMode = "Configuration" Then
        aqUtils.Delay 2000
        Set ObjConfigurationMenu = Aliases.jp2launcher.FindChild("AWTComponentName", "NavigationId[TOP1_CONFIGURATION]", 20, True)
          If ObjConfigurationMenu.Enabled Then
            Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu.Click(" |Configuration")
            Log.Checkpoint "Configuration is selected successfully"
          ElseIf Not ObjConfigurationMenu.Enabled Then
            Log.Checkpoint"Configuration is already selected"
          End If
      End If
End Sub


'To Create Carrier Service
'Input Parameters: By using Dictionary Object
'Created: 06/04/2018 
'Created by: Aswini Uthayakumar
'Reviewed:
'Reviewed by:

Sub n4CreateCarrierService
  Dim ObjCreateService,ObjServiceID,ObjServiceName,ObjMode,CarrierMode,ObjAddPoint,ObjPoint,Port(4),ObjSaveService,ObjRefresh,ObjSearch,ObjEdit,ObjTable
  Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu.Click("Windows|Close All Tabs")
  Call n4SelectWorkMode
  Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu.Click("Carriers|Carrier Services")
  aqUtils.Delay 2000
  Set ObjCreateService = Aliases.jp2launcher.FindChild("AWTComponentName","LABEL_ACTION_CREATE",20,True)
  Call CommonRoutines.ClickOperation(ObjCreateService,"Add Button")
  Set ObjServiceID = Aliases.jp2launcher.n4AddCarrierServiceWindow.FindChild("AWTComponentName","srvcId",20,True)
  Call CommonRoutines.EnterOperation(ObjServiceID,(flowData.Item("ServiceID")),"ServiceID")
  Set ObjServiceName = Aliases.jp2launcher.n4AddCarrierServiceWindow.FindChild("AWTComponentName", "srvcName", 20, True)
  aqUtils.Delay 500
  Call CommonRoutines.EnterOperation(ObjServiceName,(flowData.Item("ServiceName")),"ServiceName")
  Set ObjMode = Aliases.jp2launcher.n4AddCarrierServiceWindow.FindChild("AWTComponentName", "srvcCarrierMode", 20, True)
  aqUtils.Delay 500
  CarrierMode = (flowData.Item("CarrierMode"))
    If CarrierMode = "Vessel" Then
        ObjMode.Keys("Vessel")
    ElseIf CarrierMode = "Train" Then
        ObjMode.Keys("Train")
    ElseIf CarrierMode = "Truck" Then
        ObjMode.Keys("Truck")
    End If
  Set ObjAddPoint = Aliases.jp2launcher.n4AddCarrierServiceWindow.FindChild("AWTComponentName", "ADD_PORT", 20, True)
  Call CommonRoutines.ClickOperation(ObjAddPoint,"AddPoint Button")
  Set ObjPoint = Aliases.jp2launcher.FindChild("AWTComponentName", "chooserLookupField", 20, True)
  Port(0)=(flowData.Item("Port1"))
  Port(1)=(flowData.Item("Port2"))
  Port(2)=(flowData.Item("Port3"))
  Port(3)=(flowData.Item("Port4"))
  Port(4)=(flowData.Item("Port5"))
  Call CommonRoutines.EnterOperation(ObjPoint,Port(0),"Port1")
  Call CommonRoutines.EnterOperation(ObjPoint,(flowData.Item("EnterKey")),"Enter Key")
  Call CommonRoutines.EnterOperation(ObjPoint,Port(1),"Port2")
  Call CommonRoutines.EnterOperation(ObjPoint,(flowData.Item("EnterKey")),"Enter Key")
  Call CommonRoutines.EnterOperation(ObjPoint,Port(2),"Port3")
  Call CommonRoutines.EnterOperation(ObjPoint,(flowData.Item("EnterKey")),"Enter Key")
  Call CommonRoutines.EnterOperation(ObjPoint,Port(3),"Port4")
  Call CommonRoutines.EnterOperation(ObjPoint,(flowData.Item("EnterKey")),"Enter Key")
  Call CommonRoutines.EnterOperation(ObjPoint,Port(4),"Port5")
  Call CommonRoutines.EnterOperation(ObjPoint,(flowData.Item("EnterKey")),"Enter Key")
  Call CommonRoutines.EnterOperation(ObjPoint,(flowData.Item("EscapeKey")),"Escape Key")
  Set ObjSaveService = Aliases.jp2launcher.n4AddCarrierServiceWindow.FindChild("AWTComponentName", "LABEL_ACTION_SAVE", 20, True)
  Call CommonRoutines.ClickOperation(ObjSaveService,"Save Button")
  Set ObjRefresh = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL_ACTION_REFRESH", 20, True)
  Call CommonRoutines.ClickOperation(ObjRefresh,"Refresh Button")
  Set ObjSearch = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL__QUICK_SEARCH", 20, True)
  Call CommonRoutines.EnterOperation(ObjSearch,(flowData.Item("ServiceID")),"ServiceID")
  Call CommonRoutines.EnterOperation(ObjSearch,(flowData.Item("EnterKey")),"Enter Key")
  Set ObjTable = Aliases.jp2launcher.FindChild("AWTComponentName", "ARG035", 20, True)
  ObjTable.selectAll
  Set ObjEdit = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL_ACTION_EDIT", 20, True)
    If ObjEdit.Enabled Then
      Log.Checkpoint "Carrier Service Created Successfully"
    Else
      Log.Checkpoint "Carrier Service not found"
    End If
  aqUtils.Delay 1000
  Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu.Click("Windows|Close All Tabs")
End Sub

'To Purge Carrier Service
'Input Parameters: By using Dictionary Object
'Created: 06/04/2018 
'Created by: Soundarya
'Reviewed:
'Reviewed by:
Sub n4PurgeCarrierService
  Dim ObjSearch,ObjEdit,ObjActionsButton,ObjRefresh,ObjTable,ObjHomeView
  Set ObjHomeView = Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu
  ObjHomeView.Click("Windows|Close All Tabs")
  aqUtils.Delay 2000
  Call n4SelectWorkMode
  ObjHomeView.Click("Carriers|Carrier Services")
  Set  ObjSearch = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL__QUICK_SEARCH", 20, True)
  Call CommonRoutines.EnterOperation(ObjSearch,(flowData.Item("ServiceID")),"Search")
  Call CommonRoutines.EnterOperation(ObjSearch,(flowData.Item("EnterKey")),"Enter Key")
  Set ObjTable = Aliases.jp2launcher.FindChild("AWTComponentName", "ARG035", 20, True)
  ObjTable.selectAll
  Set ObjEdit = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL_ACTION_EDIT", 20, True)
    If ObjEdit.Enabled Then
      Log.Checkpoint "Carrier Service is present"
    Else
      Log.Checkpoint "Carrier Service is not present"
    End If
  Set ObjActionsButton = Aliases.jp2launcher.FindChild("AWTComponentName", "MENU__ACTIONS", 20, True)
  Call CommonRoutines.ClickOperation(ObjActionsButton,"Actions Button")
  ObjActionsButton.SwingPopupMenu.Click("Purge")
  Set ObjRefresh = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL_ACTION_REFRESH", 20, True)
  Call CommonRoutines.ClickOperation(ObjRefresh,"Refresh Button")
    If not ObjEdit.Enabled Then
      Log.Checkpoint "Carrier service Deleted successfully"
    Else
      Log.Checkpoint "Carrier Service already deleted"  
    End if
  aqUtils.Delay 1000
  Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu.Click("Windows|Close All Tabs")
End Sub

'ToCreate Basedata for LineOperator
'Input Parameters: By using Dictionary Object
'Created: 05/04/2018 
'Created by: Dinesh RameshKumar
'Reviewed:
'Reviewed by:

Sub n4CreateLineoperator
   Dim ObjCreateLop,ObjLinename,Save,cancel,Objsearchlop,value,verify,Lineoperator,Objname,ObjScac,ObjBIC,Objlineselec
   Set ObjHomeView = Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu
   ObjHomeView.Click("Windows|Close All Tabs")    
   ObjHomeView.Click("Organizations|Line Operators")
   aqUtils.Delay 500
   Set ObjCreateLop =  Aliases.jp2launcher.FindChild("AWTComponentName","LABEL_ACTION_CREATE",20, True)
   If  ObjCreateLop.WaitProperty("Exists", True,50000) And ObjCreateLop.WaitProperty("Visible", True,50000) Then 
    Call CommonRoutines.ClickOperation(ObjCreateLop,"CreateLineoperator")
    Set ObjLinename = Aliases.jp2launcher.n4AddLineOperatorWindow.FindChild("AWTComponentName","bzuId",20, True)
    If ObjLinename.WaitProperty("Exists", True, 40000) Then
     Call CommonRoutines.EnterOperation(ObjLinename,(flowData.Item("LineOperator")),"LineOperator") 
     Call CommonRoutines.EnterOperation(ObjLinename,"[Tab]","Tab") 
     Set Objname = Aliases.jp2launcher.n4AddLineOperatorWindow.FindChild("AWTComponentName","bzuName",20, True)
     Call CommonRoutines.ClickOperation(Objname,"LineOperatorName")
     Call CommonRoutines.EnterOperation(Objname,(flowData.Item("LineOperatorName")),"LineOperatorName") 
     Call CommonRoutines.EnterOperation(Objname,"[Tab]","Tab") 
     Set ObjScac = Aliases.jp2launcher.n4AddLineOperatorWindow.FindChild("AWTComponentName","bzuScac",20, True)
     Call CommonRoutines.ClickOperation(ObjScac,"ScacCode")
     Call CommonRoutines.EnterOperation(ObjScac,(flowData.Item("ScacCode")),"ScacCode") 
     Call CommonRoutines.EnterOperation(ObjScac,"[Tab]","Tab")
     aqUtils.Delay 1000
     Set ObjBIC = Aliases.jp2launcher.n4AddLineOperatorWindow.FindChild("AWTComponentName","bzuBic",20, True)
     Call CommonRoutines.EnterOperation(ObjBIC,(flowData.Item("BicCode")),"BicCode")
     Set Save =  Aliases.jp2launcher.n4AddLineOperatorWindow.FindChild("AWTComponentName","LABEL_ACTION_SAVE",20, True)
     Call CommonRoutines.ClickOperation(Save,"Savelineoperator")
    End If
   Set cancel =  Aliases.jp2launcher.n4AddLineOperatorWindow.FindChild("AWTComponentName","LABEL_ACTION_CANCEL",20, True)
   Call CommonRoutines.ClickOperation(cancel,"CancelLineoperator")
   Set Objsearchlop = Aliases.jp2launcher.n4HomeView.FindChild("AWTComponentName","LABEL__QUICK_SEARCH",20, True)
   Call CommonRoutines.EnterOperation(Objsearchlop,(flowData.Item("LineOperator")),"LineOperator")
   Call CommonRoutines.EnterOperation(Objsearchlop,"[Enter]","Lineoperator")
   Set  Objlineselec = Aliases.jp2launcher.FindChild("AWTComponentName","ARG088",20, True)
   Objlineselec.selectAll
   aqUtils.Delay 500 
   Set edit = Aliases.jp2launcher.FindChild("AWTComponentName","LABEL_ACTION_EDIT",20, True)
   If edit.Enabled Then
    Log.Checkpoint "Line operator Successfully created" 
   Else
    Log.Error "Line operator doesnt exists"
   End If
  End If
End Sub

'To Purge Lineoperator 
'Input Parameters: By using Dictionary Object
'Created: 05/04/2018 
'Created by: Dinesh RameshKumar
'Reviewed:
'Reviewed by:
Sub n4PurgeLineoperator
   Dim action,Objlineselect,ObjRefresh,Objminus,Objsearchop,ObjDelete
   Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu.Click("Windows|Close All Tabs")
   Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu.Click("Organizations|Line Operators")
   aqUtils.Delay 1000
   Set ObjsearchLineOperator = Aliases.jp2launcher.n4HomeView.FindChild("AWTComponentName","LABEL__QUICK_SEARCH",20, True)
   Call CommonRoutines.EnterOperation(ObjsearchLineOperator,(flowData.Item("LineOperator")),"LineOperator")
   Call CommonRoutines.EnterOperation(ObjsearchLineOperator,"[Enter]","Lineoperator")
   aqUtils.Delay 1000
   Set  Objlineselect = Aliases.jp2launcher.FindChild("AWTComponentName","ARG088",20, True)
   Objlineselect.selectAll
   aqUtils.Delay 500 
   Set Objminus =  Aliases.jp2launcher.FindChild("AWTComponentName","LABEL_ACTION_DELETE",20, True)
   If Objminus.Enabled Then
    Set action = Aliases.jp2launcher.FindChild("AWTComponentName","MENU__ACTIONS",20, True)
    action.click
    action.SwingPopupMenu.Click("Purge")
    Set ObjRefresh = Aliases.jp2launcher.FindChild("AWTComponentName","LABEL_ACTION_REFRESH",20, True)
    aqUtils.Delay 1000
    Call CommonRoutines.ClickOperation(ObjRefresh,"Refresh")
    Log.Checkpoint  "Line operator Successfully Purged " 
   Else
    Log.Checkpoint "Line operator already Purged"
   End If
End Sub

'To DeleteLineOperator
'Input Parameters: By using Dictionary Object
'Created: 05/04/2018 
'Created by: Dinesh RameshKumar
'Reviewed:
'Reviewed by:
Sub n4DeleteLinoperator
    Dim ObjSelectall,ObjDeleteButton,ObjsearchLineOperator,Objplus,ObjRefrsh
    Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu.Click("Windows|Close All Tabs")
    Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu.Click("Organizations|Line Operators")
    Set ObjsearchLineOperator = Aliases.jp2launcher.n4HomeView.FindChild("AWTComponentName","LABEL__QUICK_SEARCH",20, True)
    Call CommonRoutines.EnterOperation(ObjsearchLineOperator,(flowData.Item("LineOperator")),"LineOperator")
    Call CommonRoutines.EnterOperation(ObjsearchLineOperator,"[Enter]","Lineoperator")    
    Set  ObjSelectall = Aliases.jp2launcher.FindChild("AWTComponentName","ARG088",20, True)
    ObjSelectall.selectAll
    aqUtils.Delay 500 
    Set ObjDeleteButton =  Aliases.jp2launcher.FindChild("AWTComponentName","LABEL_ACTION_DELETE",20, True)
    If ObjDeleteButton.Enabled Then
     Set ObjDeleteButton =  Aliases.jp2launcher.FindChild("AWTComponentName","LABEL_ACTION_DELETE",20, True)
     Call CommonRoutines.ClickOperation(ObjDeleteButton,"Delete icon")
     Set Objplus =  Aliases.jp2launcher.FindChild("AWTComponentName","LABEL_YES",20, True)
     Call CommonRoutines.ClickOperation(Objplus,"Yes button")
     Set ObjRefrsh = Aliases.jp2launcher.FindChild("AWTComponentName","LABEL_ACTION_REFRESH",20, True)
     Call CommonRoutines.ClickOperation(ObjRefrsh,"Savelineoperator")
     Log.Checkpoint  "Line operator Successfully Deleted " 
    Else
     Log.Checkpoint "Line operator already Deleted"
    End If
End Sub

'Opening N4 through jnlp
'Created: 04/04/2018
'Created by: Anantha Narayanan
'Reviewed: 
'Reviewed by:
Sub n4Open
 
  ' Add a Java Web Start application to the project
  ind = TestedApps.AddJavaWebStartApp
  Set app = TestedApps.Items(ind)

  ' Specify Web Start application's launch parameters
  app.JWSLauncher = "C:\\Program Files\\Java\\jre1.8.0_60\\bin\\javaws.exe"
  app.Location = (flowData.Item("N4HOST"))+":8280/apex/apex.jnlp"
  ' Launches the Web Start application
  app.Run
  TestedApps.Clear
End Sub

'Closing N4
'Created: 04/04/2018
'Created by: Anantha Narayanan
'Reviewed: 
'Reviewed by:
Sub n4Close
  Dim AppProcess
 ' Obtains the N4 process
 Set AppProcess = Sys.Process("jp2launcher")
 ' Closes the process
 AppProcess.Close
End Sub 

'To import snx file
'Input Parameters: By using Dictionary Object
'Created: 25/04/2018 
'Created by: Aswini Uthayakumar
'Reviewed:
'Reviewed by:
Sub n4ImportSnxFile(FileName)
  Dim ObjHomeView,ObjImportXmlFile,ObjProcessFile
  Set ObjHomeView = Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu
  ObjHomeView.Click("Windows|Close All Tabs")
  Call n4SelectWorkMode("Administration")
  aqUtils.Delay 1000
  ObjHomeView.Click("DBA|Import SNX File")
  If Aliases.jp2launcher.n4SnxImporterWindow.WaitProperty("Exists", True,50000)Then
    Set ObjImportXmlFile = Aliases.jp2launcher.n4SnxImporterWindow.FindChild("AWTComponentName", "LABEL__XML_LOADER_IMPORT", 20, True)
    Call CommonRoutines.ClickOperation(ObjImportXmlFile,"Import XML File Button")
      If Aliases.jp2launcher.FindChild("AWTComponentAccessibleName", "Open", 20, True).WaitProperty("Exists", True,50000)Then
        Set ObjFileName = Aliases.jp2launcher.FindChild("AWTComponentAccessibleName", "File Name:", 20, True)
        Call CommonRoutines.EnterOperation(ObjFileName,FileName,"xml file to be posted")
        Call CommonRoutines.EnterOperation(ObjFileName,"[Enter]","Enter the file")
        Set ObjMessage = Aliases.jp2launcher.n4SnxImporterWindow.FindChild("AWTComponentName", "messageField", 20, True)
        Set Message = ObjMessage.getText
          If Message.contains("import SUCCESSFUL")Then
            Log.Checkpoint("Snx imported Successfully")
          Else
            Log.Checkpoint("Snx import failed")
          End If   
        Aliases.jp2launcher.n4SnxImporterWindow.Close      
      End If
  End If
End Sub

'To Search Unit
'Input Parameters: By using Dictionary Object
'Created: 08/05/2018 
'Created by: Anantha Narayanan
'Reviewed:
'Reviewed by:
Sub n4SearchUnit
  Dim ObjHomeView,ObjSearchUnit,ObjProcessFile
  Set ObjHomeView = Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu
  Call n4SelectWorkMode("Operations")
  ObjHomeView.Click("Windows|Close All Tabs")
  ObjHomeView.Click("Unit|Units")
  Set ObjSearchUnit = Aliases.jp2launcher.n4HomeView.FindChild("AWTComponentName","LABEL__QUICK_SEARCH",20, True)
  Call CommonRoutines.EnterOperation(ObjSearchUnit,(flowData.Item("UnitId")),"Container Number")
  Call CommonRoutines.EnterOperation(ObjSearchUnit,"[Enter]","Container Number")
End Sub

'To Delete Unit
'Input Parameters: By using Dictionary Object
'Created: 15/05/2018 
'Created by: Aswini Uthayakumar
'Reviewed:
'Reviewed by:
Sub n4DeleteUnit(UnitId)
  Dim ObjAction, objDeleteDialogBox, ObjDeleteYes, ObjHomeView, ObjRefresh, ObjSearchUnit, ObjSelectall
  Set ObjHomeView = Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu
  Call n4SelectWorkMode("Operations")
  ObjHomeView.Click("Windows|Close All Tabs")
  ObjHomeView.Click("Unit|Units")
  aqUtils.Delay 1000
  Set ObjSearchUnit = Aliases.jp2launcher.n4HomeView.FindChild("AWTComponentName","LABEL__QUICK_SEARCH",20, True)
  Call CommonRoutines.EnterOperation(ObjSearchUnit,UnitId,"Container Number")
  Call CommonRoutines.EnterOperation(ObjSearchUnit,"[Enter]","Container Number")
  Set  ObjSelectall = Aliases.jp2launcher.FindChild("AWTComponentName","INV007",20, True)
  ObjSelectall.selectAll
  Set ObjAction = Aliases.jp2launcher.FindChild("AWTComponentName","MENU__ACTIONS",20, True)
  Call CommonRoutines.ClickOperation(ObjAction,"Action Button")
    If  Aliases.jp2launcher.FindChild("AWTComponentName", "List Selected", 20, True).Enabled Then
      ObjAction.SwingPopupMenu.Click("Administration|Delete Unit")
      Set objDeleteDialogBox= Aliases.jp2launcher.FindChild("AWTComponentName","optionDialog",20,True)
        If ObjDeleteDialogBox.Enabled Then
          Log.Checkpoint("Delete dialog box found")
        Else
          Log.Checkpoint ("Delete dialog box not found")
        End If
      Set ObjDeleteYes = Aliases.jp2launcher.FindChild("AWTComponentName","LABEL_YES",20,True)
      Call CommonRoutines.ClickOperation(ObjDeleteYes,"Delete- yes button")
      Set ObjRefresh = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL_ACTION_REFRESH", 20, True)
      Call CommonRoutines.ClickOperation(ObjRefresh,"Refresh Button")
      Call CommonRoutines.EnterOperation(ObjSearchUnit,UnitId,"Container Number")
      Call CommonRoutines.EnterOperation(ObjSearchUnit,"[Enter]","Container Number")
      Call CommonRoutines.ClickOperation(ObjAction,"Action Button")
      aqUtils.Delay 1000
        If not Aliases.jp2launcher.FindChild("AWTComponentName", "List Selected", 20, True).Enabled Then
          Log.Checkpoint("Unit deleted Successfully")
        Else
          Log.Checkpoint("Failed to delete Unit")
        End If
    Else
      Log.Checkpoint("Unit Not found")
    End If
End Sub

'To Attach Unit
'Input Parameters: By using Dictionary Object
'Created: 21/05/2018 
'Created by: Aswini Uthayakumar
'Reviewed:
'Reviewed by:
Sub n4AttachUnit
  Dim ObjAdd, ObjAllowSwipe, Objdropdown, ObjEquipmentNumber, ObjEquipmentRole, ObjSave, ObjSearch, ObjSelectall, ObjSelectallEquipment, Objwin
  Call n4SearchUnit
  Set  ObjSelectall = Aliases.jp2launcher.FindChild("AWTComponentName","INV007",20, True)
  ObjSelectall.selectAll
  ObjSelectall.Keys("[Enter]")
  Set Objwin = Aliases.jp2launcher.n4UnitInspectorWindow
  Call Objwin.Position(0, 0, 600, 400)
  Set Objdropdown = Aliases.jp2launcher.n4UnitInspectorWindow.FindChild("AWTComponentName","INSPECTION_TOGGLE_BUTTON",20, True)
  Call CommonRoutines.ClickOperation(Objdropdown,"Dropdown")
  Set ObjAdd = Aliases.jp2launcher.n4UnitInspectorWindow.FindChild("AWTComponentName","LABEL_ACTION_CREATE",20, True)
  Call CommonRoutines.ClickOperation(ObjAdd,"Add button")
  Set ObjEquipmentNumber = Aliases.jp2launcher.n4AttachEquipmentWindow.FindChild("AWTComponentName","unitEquipment.eqIdFull",20, True)
  Call CommonRoutines.EnterOperation(ObjEquipmentNumber,flowData.Item("EquipmentToBeAttached"),"Equipment Number")
  Set ObjEquipmentRole = Aliases.jp2launcher.n4AttachEquipmentWindow.FindChild("AWTComponentName","ueGeneratedRole",20, True)
  Call CommonRoutines.EnterOperation(ObjEquipmentRole,flowData.Item("EquipmentRole"),"Equipment Role")
  Set ObjAllowSwipe = Aliases.jp2launcher.n4AttachEquipmentWindow.FindChild("AWTComponentName","unitAllowSwipe",20, True)
  Call CommonRoutines.ClickOperation(ObjAllowSwipe,"Uncheck Allow swipe")
  Set ObjSave = Aliases.jp2launcher.n4AttachEquipmentWindow.FindChild("AWTComponentName","LABEL_ACTION_SAVE",20, True)
  Call CommonRoutines.ClickOperation(ObjSave,"Save Button")
  Set ObjSearch = Aliases.jp2launcher.n4UnitInspectorWindow.FindChild("AWTComponentName","LABEL__QUICK_SEARCH",20, True)
  Call CommonRoutines.EnterOperation(ObjSearch,flowData.Item("EquipmentToBeAttached"),"Search")
  Call CommonRoutines.EnterOperation(ObjSearch,"[Enter]","Search")
  Set  ObjSelectallEquipment = Aliases.jp2launcher.n4UnitInspectorWindow.FindChild("AWTComponentName","INV041",20, True)
  ObjSelectallEquipment.selectAll
    If Aliases.jp2launcher.n4UnitInspectorWindow.FindChild("AWTComponentName", "LABEL_ACTION_DELETE", 20, True).Enabled Then
      Log.Checkpoint("Equipment Attached to unit successfully")
    Else
      Log.Checkpoint("Failed to Attach Equipment")
    End If
      Aliases.jp2launcher.n4UnitInspectorWindow.Close
End Sub


'To Process WebRequest in ArgoServiceTester
'Input Parameters: By using Dictionary Object
'Created: 18/05/2018
'Created by: Dinesh RameshKumar
'Reviewed: 
'Reviewed by:
Sub n4ProcessWebRequest
  Call CommonRoutines.fetchData("SparcsN4CommonRoutines")
  Dim ObjPassword,ObjBasicRequest,writefile,fso,strFilewrite,objFileToWrite,Objmessagefields,Objgetvalue
  Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu.Click("Windows|Close All Tabs")
  Call n4SelectWorkMode("Administration")
  Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu.Click("Debug|argoservice Tester")
  aqUtils.Delay 1000
  Set ObjPassword = Aliases.jp2launcher.FindChild("AWTComponentName", "argoserviceTesterPassword", 20, True)
  Call CommonRoutines.ClickOperation(ObjPassword,"Password clicked")
  Call CommonRoutines.EnterOperation(ObjPassword,(flowData.Item("Password")),"Password Entered")
  Set ObjBasicRequest = Aliases.jp2launcher.FindChild("AWTComponentName", "SEND_BASIC_REQUEST", 20, True)
  Call CommonRoutines.EnterOperation(ObjBasicRequest,"[Enter]","Send basic request")
  Set ObjMessagefields = Aliases.jp2launcher.FindChild("AWTComponentName", "requestMessageField", 20, True)
  Call CommonRoutines.ClickOperation(ObjMessagefields,"MessageField clicked")
  ObjMessagefields.selectAll
  Call n4ReadWebServiceRequest
  ObjMessagefields.Keys(strFileText) 
  Set ObjBasicRequest = Aliases.jp2launcher.FindChild("AWTComponentName", "SEND_BASIC_REQUEST", 20, True)
  Call CommonRoutines.ClickOperation(ObjBasicRequest,"Send basic request clicked") 
  Set Objmessagefields = Aliases.jp2launcher.FindChild("AWTComponentName", "responseMessageField", 20, True)
  aqUtils.Delay 1000 
  set Objgetvalue = Objmessagefields.getText
  Log.Message(Objgetvalue)
'  If Objgetvalue.contains("Successful") Then
  Delay 2000
If Objgetvalue.contains(flowData.Item("n4ArgoServicevalue")) Then
   Log.Message "WebRequest Successfully processed in ArgoServiceTester"
  Else
   Log.Message "Failed to Process WebRequest in ArgoServiceTester"
  End If
End Sub


'To Read WebRequest from Text file
'Input Parameters: By using Dictionary Object
'Created: 04/06/2018
'Created by: Aswini UthayaKumar
'Reviewed: 
'Reviewed by:
Dim strFileText
Sub n4ReadWebServiceRequest
  Set objFSO = CreateObject("Scripting.FileSystemObject")
  Const ForReading = 1 
  Call CommonRoutines.GetCurrentDirectory
  Dim StrRequest 
  StrRequest = flowData.Item("WebRequest")
  Directory = CurrentDirectory+"\ScriptData\WebServiceRequest"+StrRequest
  Set objTextFile = objFSO.OpenTextFile(Directory, ForReading)
  strFileText = objTextFile.ReadAll
  objTextFile.Close 
End Sub

'To Create n4Accessories
'Input Parameters: By using Dictionary Object
'Created: 27/06/2018
'Created by: DineshRameshKumar
'Reviewed: 
'Reviewed by:
Sub n4CreateAccessories
  Dim ObjCreateAccessories,ObjAcccesoriesCreate,ObjEquipmentID,ObjEquipmentType,ObjEquipmentOperator,ObjEquipmentOwner,ObjAccessoriesverify,ObjTareWeigth,ObjAccessoriessave
  Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu.Click("Windows|Close All Tabs")
  Call n4SelectWorkMode("Configuration")
  Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu.Click("Equipment|Accessories")
  aqUtils.Delay 1000
  Set ObjCreateAccessories = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL_ACTION_CREATE", 20, True)
  If ObjCreateAccessories.WaitProperty("Visible", True,50000)Then
   Call CommonRoutines.ClickOperation(ObjCreateAccessories,"CreateAccessories")
   Set ObjEquipmentID = Aliases.jp2launcher.n4AddAccessories.FindChild("AWTComponentName","eqIdFull", 20, True)
   If ObjEquipmentID.WaitProperty("Visible", True,50000)Then
    Call CommonRoutines.EnterOperation(ObjEquipmentID,flowData.Item("UnitIdEquip"),"EquipmentID")
    Set ObjEquipmentType = Aliases.jp2launcher.n4AddAccessories.FindChild("AWTComponentName","acryEqType", 20, True)
    Call CommonRoutines.EnterOperation(ObjEquipmentType,flowData.Item("EquipmentType"),"EquipmentType")
    Delay 1000
    Call CommonRoutines.EnterOperation(ObjEquipmentType,"[Enter]","Entered")
    Delay 2000 
    Set ObjEquipmentOwner = Aliases.jp2launcher.n4AddAccessories.FindChild("AWTComponentName","equipmentOwner", 20, True)
    Call CommonRoutines.EnterOperation(ObjEquipmentOwner,flowData.Item("EquipmentOwner"),"EquipmentOperator")
    Delay 1000
    Call CommonRoutines.EnterOperation(ObjEquipmentOwner,"[Enter]","Entered")
    Delay 2000 
    Set ObjEquipmentOperator = Aliases.jp2launcher.n4AddAccessories.FindChild("AWTComponentName","equipmentOperator", 20, True)
    Call CommonRoutines.EnterOperation(ObjEquipmentOperator,flowData.Item("EquipmentOperator"),"EquipmentOperator")
    Delay 1000
    Call CommonRoutines.EnterOperation(ObjEquipmentOperator,"[Enter]","Entered")
    Set ObjTareWeigth = Aliases.jp2launcher.n4AddAccessories.FindChild("AWTComponentName","eqTareWeightKg", 20, True)
    ObjTareWeigth.SetText(flowData.Item("EquipmentWeigth")) 
    Delay 1000 
    Call CommonRoutines.ClickOperation(ObjTareWeigth,"Entered") 
    Set ObjAccessoriessave = Aliases.jp2launcher.n4AddAccessories.FindChild("AWTComponentName", "LABEL_ACTION_SAVE", 20, True)
    If ObjAccessoriessave.WaitProperty("Visible", True,50000)Then
     Call CommonRoutines.ClickOperation(ObjAccessoriessave,"n4AccessorieCreated")
     Set ObjAccessoriesverify = Aliases.jp2launcher.FindChild("AWTComponentName", "LABEL__QUICK_SEARCH", 20, True)
     If ObjAccessoriesverify.WaitProperty("Visible", True,50000)Then
      Log.Message "N4Accessories Successfully created"
     Else 
      Log.Message "Failed to create N4 Accessories"
     End If
    End If   
   End If
 End If 
End Sub

'To Create VesselStow Plan
'Input Parameters: By using Dictionary Object
'Created: 28/06/2018
'Created by: DineshRameshKumar
'Reviewed: 
'Reviewed by:
Sub n4CreateVesselStowPlan
  Dim ObjVesselid,ObjEquipmentid,ObjEquipmenverify,ObjEquipmenttypeverify,ObjEquipmentsave,ObjEquipmenttype,ObjEquipmentOperator,ObjVesselFreigthKind,ObjSaveVessselStowPlan,ObjVesselCategory,ObjVesselPortofLoad,ObjVesselPortOfDischarge,ObjVesselVGMWeigth,ObjVesselGrossWeigth
  Call CommonRoutines.fetchData("SparcsN4CommonRoutines")
  Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu.Click("Windows|Close All Tabs")
  Delay 1000
  Call n4SelectWorkMode("Operations")
  Aliases.jp2launcher.n4HomeView.n4MainMenuBar.SwingMenu.Click("Vessel|Vessel Stow Plan") 
  Delay 500
  Set ObjVesselid = Aliases.jp2launcher.n4AddVesselStowPlanWindow.FindChild("AWTComponentName","unitInboundVessel", 20, True)
  Call CommonRoutines.EnterOperation(ObjVesselid,flowData.Item("n4Vesselid"),"CesselID")
  Call CommonRoutines.EnterOperation(ObjVesselid,"[Enter]","Entered")
  Set ObjEquipmentid = Aliases.jp2launcher.n4AddVesselStowPlanWindow.FindChild("AWTComponentName","unitEquipment.eqIdFull", 20, True)
  Call CommonRoutines.EnterOperation(ObjEquipmentid,flowData.Item("n4UnitID"),"Equipment")
  Call CommonRoutines.EnterOperation(ObjEquipmentid,"[Enter]","Entered")
  Delay 1000
	If Aliases.jp2launcher.n4AddequipmentDialog.FindChild("AWTComponentName","eqIdFull", 20, True).Exists Then
    Set ObjEquipmenverify = Aliases.jp2launcher.n4AddequipmentDialog.FindChild("AWTComponentName","eqIdFull", 20, True)
		Call CommonRoutines.EnterOperation(ObjEquipmenverify,flowData.Item("n4UnitID"),"Equipment")
		'Call CommonRoutines.EnterOperation(ObjEquipmentid,"[Enter]","Entered")
		Delay 500
		Set ObjEquipmenttypeverify = Aliases.jp2launcher.n4AddequipmentDialog.FindChild("AWTComponentName","eqEquipType", 20, True)
		' If ObjEquipmenttypeverify.WaitProperty("Visible", True,50000)Then
		Call CommonRoutines.EnterOperation(ObjEquipmenttypeverify,flowData.Item("n4EquipmntType"),"EquipmentType")
		Call CommonRoutines.EnterOperation(ObjEquipmenttypeverify,"[Enter]","EquipmentType")
		Set ObjEquipmentsave = Aliases.jp2launcher.n4AddequipmentDialog.FindChild("AWTComponentName","LABEL_ACTION_SAVE", 20, True)
		Call CommonRoutines.ClickOperation(ObjEquipmentsave,"n4VesselEquipmentVerified")
  Else
			Set ObjEquipmenttype = Aliases.jp2launcher.n4AddVesselStowPlanWindow.FindChild("AWTComponentName","unitEquipment.eqEquipType", 20, True)
			Call CommonRoutines.EnterOperation(ObjEquipmenttype,flowData.Item("n4EquipmntType"),"EquipmentType")
			Set ObjEquipmentOperator = Aliases.jp2launcher.n4AddVesselStowPlanWindow.FindChild("AWTComponentName","unitLineOperator", 20, True)
			Call CommonRoutines.EnterOperation(ObjEquipmentOperator,flowData.Item("n4EquipmntLineOperator"),"EquipmentLineOperator")
			Call CommonRoutines.EnterOperation(ObjEquipmentOperator,"[Enter]","Entered")
			Set ObjVesselFreigthKind = Aliases.jp2launcher.n4AddVesselStowPlanWindow.FindChild("AWTComponentName","unitFreightKind", 20, True)
			Call CommonRoutines.EnterOperation(ObjVesselFreigthKind,flowData.Item("n4VesselFreigthKind"),"VesselFreigthKind")
			Set ObjVesselGrossWeigth = Aliases.jp2launcher.n4AddVesselStowPlanWindow.FindChild("AWTComponentName","unitGoodsAndCtrWtKg", 20, True)
			Call CommonRoutines.EnterOperation(ObjVesselGrossWeigth,flowData.Item("n4VesselGrossWeigth"),"VesselGrossWeigth")
			Set ObjVesselVGMWeigth = Aliases.jp2launcher.n4AddVesselStowPlanWindow.FindChild("AWTComponentName","unitGoodsAndCtrWtKgVerfiedGross", 20, True)
			Call CommonRoutines.EnterOperation(ObjVesselVGMWeigth,flowData.Item("n4VesselVGMWeigth"),"VesselVGMWeigth")
			Set ObjVesselPortofLoad = Aliases.jp2launcher.n4AddVesselStowPlanWindow.FindChild("AWTComponentName","unitRouting.rtgPOL", 20, True)
			Call CommonRoutines.EnterOperation(ObjVesselPortofLoad,flowData.Item("n4VesselPortofLoad"),"VesselPortofLoad")
			Delay 1000
			Call CommonRoutines.EnterOperation(ObjVesselPortofLoad,"[Enter]","Entered")
			Set ObjVesselPortOfDischarge = Aliases.jp2launcher.n4AddVesselStowPlanWindow.FindChild("AWTComponentName","unitRouting.rtgPOD1", 20, True)
			Call CommonRoutines.EnterOperation(ObjVesselPortOfDischarge,flowData.Item("n4VesselPortOfDischarge"),"VesselPortOfDischarge")
			Call CommonRoutines.EnterOperation(ObjVesselPortOfDischarge,"[Enter]","Entered")
			Delay 1000
			Set ObjVesselCategory = Aliases.jp2launcher.n4AddVesselStowPlanWindow.FindChild("AWTComponentName","unitCategory", 20, True)
			Call CommonRoutines.EnterOperation(ObjVesselCategory,flowData.Item("n4VesselCategory"),"VesselCategory")
			Set ObjSaveVessselStowPlan = Aliases.jp2launcher.n4AddVesselStowPlanWindow.FindChild("AWTComponentName","LABEL_ACTION_SAVE", 20, True)
			Call CommonRoutines.ClickOperation(ObjSaveVessselStowPlan,"n4VesselStowplanCreated")
			Set ObjVessselCancel = Aliases.jp2launcher.n4AddVesselStowPlanWindow.FindChild("AWTComponentName","LABEL_ACTION_CANCEL", 20, True)
			Call CommonRoutines.ClickOperation(ObjVessselCancel,"n4VesselCLose")
			Set ObjVessselclose = Aliases.jp2launcher.FindChild("AWTComponentName","LABEL_YES", 20, True)
			Call CommonRoutines.ClickOperation(ObjVessselclose,"n4Vesselexit") 
	End If
End Sub

'Copy Snx file from Source to temporary folder
'Input parameters : Snx file name
'Created: 03/07/2018
'Created by: Aswini Uthayakumar
'Reviewed: 
'Reviewed by:
Sub CopySnxFile(SnxFile)
  Call CommonRoutines.GetCurrentDirectory
  Log.Message(CurrentDirectory)
  Log.Message(CurrentDirectory+"\ScriptData\SNX\Temp\"+"ReceiveEmptyUnit2200.xml")
  Log.Message(CurrentDirectory)
  Set objFileToRead = CreateObject("Scripting.FileSystemObject").OpenTextFile(CurrentDirectory+"\ScriptData\SNX\"+SnxFile,1)
  strFileText = objFileToRead.ReadAll()
  objFileToRead.Close
  Set objFSO = CreateObject("Scripting.FileSystemObject") 
  Set objFileToWrite = objFSO.OpenTextFile(CurrentDirectory+"\ScriptData\SNX\Temp\"+SnxFile, 2)
  objFileToWrite.Write strFileText
  objFileToWrite.Close
End Sub

'Replacing String in Snx file
'Input parameters : Snx file along with path,Key in Snx, Value which need to replace the Kap in SNX
'Created: 03/07/2018
'Created by: Aswini Uthayakumar
'Reviewed: 
'Reviewed by:
Sub ReplaceStringInSnx(SnxFile,Stringkey,Stringval)
  Dim Contentintxtfile,readfile,writefile
  SnxFileName = SnxFile
  Call CopySnxFile(SnxFile)
  Set FSO = CreateObject("scripting.filesystemobject")
  Set readfile = fso.OpenTextFile (CurrentDirectory+"\ScriptData\SNX\Temp\"+SnxFileName, 1) 
  Contentintxtfile = readfile.ReadAll
'  Arraykey = Split(Stringkey , "~")
  Arrayval = Split(Stringval , "~")
  Lengthkey = UBound(Stringkey)
  Lengthval = UBound(Arrayval)
  If Lengthkey = Lengthval Then 
    For i = LBound(Stringkey) to UBound(Stringkey)
      Contentintxtfile = Replace(Contentintxtfile,Stringkey(i),Arrayval(i))
    Next
  Else
    Log.Error "Key length and value length are not matching"    
  End If
  Set writefile = fso.OpenTextFile(CurrentDirectory+"\ScriptData\SNX\Temp\"+SnxFile, 2)
  writefile.WriteLine(Contentintxtfile)
  readfile.Close
  writefile.Close                                                               
  Set FSO=Nothing
End Sub

Sub Play
'Call CommonRoutines.fetchData("YINV_YINS_101")
'ValInScript = Array("GUnitId","GLineOperator","GYardSlot")
'Call ReplaceStringInSnx("C:\Users\ITL-USER\Desktop\TestComplete\Basic Test Suite\ScriptData\SNX\Temp\ReceiveEmptyUnit2200.xml",ValInScript,"ASWU2705190~ASW~F10L.1")
Call CopySnxFile("ReceiveEmptyUnit2200.xml")
End Sub
