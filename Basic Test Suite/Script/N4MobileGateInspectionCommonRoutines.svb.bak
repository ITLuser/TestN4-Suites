'USEUNIT CommonRoutines
'USEUNIT N4MobileCommonRoutines

'To Enter Container or Chassis for GateInspection in N4 Mobile
'Input Parameters: By using Dictionary Object
'Created: 13/06/2018 
'Created by: Aswini Uthayakumar
'Reviewed:
'Reviewed by:
Sub n4mobileGateInspectionEnterContainerOrChassis
Call CommonRoutines.fetchData("N4MobileCommonRoutines")
  Set ObjContainer = Aliases.browser.FindChild("idStr","program:MROD001-mContainer_input",20,True)
  Set ObjChassis = Aliases.browser.FindChild("idStr","program:MROD005-inspChassisId_input",20,True)
    If ObjContainer.WaitProperty("Exists", True,5000) Then
      SelContainerOrChassis = (flowData.Item("n4GInspContainerOrChassis"))
        If SelContainerOrChassis = "Container" Then
          ObjContainer.SetText(flowData.Item("n4GInspContainerNbr"))
          ObjChassis.setText(" ")
          Set ObjSend = Aliases.browser.FindChild("idStr","program:one_2_SEND",20,True)
          Call CommonRoutines.ClickOperation(ObjSend,"Send Button")
          Set ObjCheckElement = Aliases.browser.FindChild("idStr","program:MROD002-mLicense_input",20,True)
            If ObjCheckElement.WaitProperty("Exists", True,5000) Then
              Log.Checkpoint("Container Entered for Gate Inspection")
            Else
              Log.Error("Failed to enter Container for Gate Inspection")
            End If
        ElseIf SelContainerOrChassis = "Chassis" Then
          ObjContainer.SetText(" ")
          ObjChassis.SetText(flowData.Item("n4GInspChassisNbr"))
          Set ObjSend = Aliases.browser.FindChild("idStr","program:one_2_SEND",20,True)
          Call CommonRoutines.ClickOperation(ObjSend,"Send Button")
          Set ObjCheckElement = Aliases.browser.FindChild("idStr","program:MROD002-mLicense_input",20,True)
            If ObjCheckElement.WaitProperty("Exists", True,5000) Then
              Log.Checkpoint("Chassis Entered for Gate Inspection")
            Else
              Log.Error("Failed to enter Chassis for Gate Inspection")
            End If
        End If
    End If
End Sub