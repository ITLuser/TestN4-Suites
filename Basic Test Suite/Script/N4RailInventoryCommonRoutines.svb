'USEUNIT CommonRoutines
'USEUNIT N4MobileCommonRoutines

'To Enter raicarid in  RailInventory
'Input Parameters: By using Dictionary Object
'Created: 06/06/2018 
'Created by: Dinesh RameshKumar
'Reviewed:

Sub  n4mobileRailcaridRailInventory
  Dim Objunit,ObjClick
  Set ObjRailcarid = Aliases.browser.FindChild("idStr", "program:MRIV001-mrivRailcarID_input", 20, True) 
   If ObjRailcarid.WaitProperty("Exists", True,5000) Then 
    Call CommonRoutines.EnterOperation(ObjRailcarid,flowData.Item("n4RailInventoryRailCarId"),"RailCarIDEntered")
    Set ObjClick = Aliases.browser.FindChild("idStr", "program:one_2_SEND", 20, True) 
    Call CommonRoutines.ClickOperation(ObjClick,"Clickedsend") 
    Delay 1000
    If Aliases.browser.FindChild("idStr", "program:MRIV003-mrivRailcarEditButton_input", 20, True).WaitProperty("Visible", True,5000) Then
     Log.Checkpoint("RailCarID Entered for RailInventory is  successful")
    Else
     Log.Checkpoint("RailCarID Entered for RailInventory is  unsuccessful") 
    End If
   End If  
End Sub

'To Add Railcartype RailInventory
'Input Parameters: By using Dictionary Object
'Created: 06/06/2018 
'Created by: Dinesh RameshKumar
'Reviewed:
 
Sub n4MobileRailCarTypeRailInventory
  Dim ObjEdit,ObjCarType,ObjDamage,SelectFlip,SelDamage,ObjInspected,SelectInspect
  Set ObjEdit = Aliases.browser.FindChild("idStr", "program:MRIV003-mrivRailcarEditButton_input", 20, True)
  Call CommonRoutines.ClickOperation(ObjEdit,"ClickedEditButton") 
  Delay 1000
  Set ObjCarType = Aliases.browser.FindChild("idStr", "program:MRIV006-mrivEditRailcarType_input", 20, True)
  Call CommonRoutines.EnterOperation(ObjCarType,flowData.Item("n4MobileCartype"),"RailCarTypeEntered")
  Delay 2000
  Set ObjDamage = Aliases.browser.FindChild("idStr","program:MRIV006-mrivEditRailcarIsDamaged_input",20,True)
  If ObjDamage.WaitProperty("Visible", True,5000) Then
   Selectrailtype = flowData.Item("n4SelectrailDamage")
   If Selectrailtype = "Yes" Then
    Call CommonRoutines.ClickOperation(ObjDamage,"DamageClicked")
   Else
    Log.Message "Damage not Clicked"
   End If 
  End If 
  Set ObjInspected = Aliases.browser.FindChild("idStr","program:MRIV006-mrivEditRailcarIsInspected_input",20,True)
   If ObjInspected.WaitProperty("Visible", True,5000) Then
    Selectrailtype = flowData.Item("n4SelectrailInspect")
   If Selectrailtype = "Yes" Then
     Call CommonRoutines.ClickOperation(ObjInspected,"Inspected Clicked")
    Else
     Log.Message "Inspect not Selected"
    End If 
   End If
  Delay 2000   
  Set ObjFlipped= Aliases.browser.FindChild("idStr","program:MRIV006-mrivEditRailcarIsFlip_input",20,True)  
  If ObjFlipped.WaitProperty("Visible", True,5000) Then
   Selectrailtype = flowData.Item("n4SelectrailFlipped")
   If Selectrailtype = "Yes" Then
    Call CommonRoutines.ClickOperation(ObjFlipped,"Flipped Clicked")
   Else
    Log.Message "Flipped not Selected"
   End If
  End If
  Set ObjClick = Aliases.browser.FindChild("idStr", "program:optional_2_SEND", 20, True) 
  Call CommonRoutines.ClickOperation(ObjClick,"Clickedsend") 
  Delay 1000
  If Aliases.browser.FindChild("idStr", "program:MRIV003-mrivRailcarIDLabel_outputText", 20, True).WaitProperty("Visible", True,5000) Then
    Log.Message "Succesfully Clicked the railcartype"
  Else
   Log.Message "Failed To click the railcartype"
  End If
End Sub

'To Add Track,Position of RailInventory
'Input Parameters: By using Dictionary Object
'Created: 11/06/2018 
'Created by: Dinesh RameshKumar
'Reviewed:
Sub n4MobileRailTrackPositioninRailInventory
  Dim ObjTrack,ObjPosition,ObjMeterMark,ObjTransferPoint
  Set ObjTrack  = Aliases.browser.FindChild("idStr", "program:MRIV003-mrivRailcarTrack_input", 20, True)
  Call CommonRoutines.EnterOperation(ObjTrack,flowData.Item("n4Track"),"RailCarTrackEntered")
  Set ObjPosition = Aliases.browser.FindChild("idStr", "program:MRIV003-mrivRailcarTrackPos_input", 20, True)
  Call CommonRoutines.EnterOperation(ObjPosition,flowData.Item("n4Position"),"RailCarPositionEntered")
  Set ObjTransferPoint = Aliases.browser.FindChild("idStr", "program:MRIV003-mrivRailcarTransferPoint_input", 20, True)
  Call CommonRoutines.EnterOperation(ObjTransferPoint,flowData.Item("n4TransferPoint"),"RailCarPositionEntered")
  Set ObjMeterMark = Aliases.browser.FindChild("idStr", "program:MRIV003-mrivRailcarMeterMark_input", 20, True)
  Call CommonRoutines.EnterOperation(ObjMeterMark,flowData.Item("n4Metermark"),"RailCarMetrmarkEntered")
End Sub  

'To Add EditSeg Break of RailInventory
'Input Parameters: By using Dictionary Object
'Created: 11/06/2018 
'Created by: Dinesh RameshKumar
'Reviewed:
Sub n4AddEditSegBreakRailInventory
  Dim ObjEditSegBreak,ObjClickEditsegBreak,ObjSend
  Set ObjEditSegBreak  = Aliases.browser.FindChild("idStr", "program:MRIV003-mrivEditSegBreakButton_input", 20, True)
  Delay 1000
  Call CommonRoutines.ClickOperation(ObjEditSegBreak,"EditSegButtonClicked")
  Set ObjClickEditsegBreak  = Aliases.browser.FindChild("idStr", "program:MRIV_EDIT_SEG_BREAK-mrivEditRailcarDisconnectedAtLow_input", 20, True)  
  If ObjClickEditsegBreak.WaitProperty("Exists", True,5000) Then
   SelectSegButton = flowData.Item("n4ClickEditSegBreak")    
   If SelectSegButton = "Yes" Then
    Call CommonRoutines.ClickOperation(ObjClickEditsegBreak,"EditSegButtonClicked")
    Set ObjSend  = Aliases.browser.FindChild("idStr", "program:optional_2_SEND", 20, True)
    Call CommonRoutines.ClickOperation(ObjSend,"ClickedSendButton")
    Set ObjVerify = Aliases.browser.FindChild("idStr", "program:MRIV003-mrivRailcarEditButton_input", 20, True)
    Delay 1000
    If ObjVerify.WaitProperty("Visible", True,5000) Then 
     Log.Message "EditSegButton Sucessfully Clicked"
    Else 
     Log.Message "EditSegButton Clicked UnSucessfully"
    End If
   End If 
  End If
End Sub
 
'To Add QueryContainer in RailInventory
'Input Parameters: By using Dictionary Object
'Created: 11/06/2018 
'Created by: Dinesh RameshKumar
'Reviewed:
Sub n4MobileAddContainerRailInventory
  Dim ObjContainer1
  Set ObjContainer1  = Aliases.browser.FindChild("idStr", "program:MRIV0041_variField_valuetable:dataTable:0:column_1", 20, True)
  If ObjContainer1.WaitProperty("Visible", True,5000) Then  
  Call CommonRoutines.EnterOperation(ObjContainer1,flowData.Item("n4AddContainer1"),"ContaineridEntered")
  Set ObjSubmitContainer  = Aliases.browser.FindChild("idStr", "program:MRIV0041_variField_valuetable:dataTable:0:column_2", 20, True)
  Call CommonRoutines.ClickOperation(ObjSubmitContainer,"ContainerSubmitted")
  Set ObjSubmitContainer  = Aliases.browser.FindChild("idStr", "program:MRIVContInsp-mrivUnitID_outputText", 20, True)
  If ObjSubmitContainer.WaitProperty("Visible", True,5000) Then 
   Log.Message "Container Entered Sucessfully"
  Else 
   Log.Message "Container Entered Unsucessfully" 
  End If  
  End If 
  Set ObjContainer2  = Aliases.browser.FindChild("idStr", "program:MRIV0041_variField_valuetable:dataTable:0:column_1", 20, True)
  Call CommonRoutines.EnterOperation(ObjContainer1,flowData.Item("n4AddContainer"),"ContaineridEntered")
End Sub


Sub play
  Call CommonRoutines.fetchData("N4MobileCommonRoutines")
  Call N4MobileCommonRoutines.n4mobileLogin  
  Call N4MobileCommonRoutines.n4mobileScopeSelection  
  Call CommonRoutines.fetchData("N4MobileRailInventory") 
  Call N4MobileCommonRoutines.n4mobileSelectProgram                             
  Call n4mobileRailcaridRailInventory
  Call n4AddEditSegBreakRailInventory


End Sub

 
 
 
 